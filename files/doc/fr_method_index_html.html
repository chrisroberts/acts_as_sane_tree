<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>File: fr_method_index.html [RDoc Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='file' id='wrapper'>
      <div class='header'>
        <h1 class='name'>fr_method_index.html</h1>
        <div class='paths'>
          doc/fr_method_index.html
        </div>
        <div class='last-update'>
          Last Update:
          <span class='datetime'>Mon Oct 25 17:59:05 -0700 2010</span>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            <!DOCTYPE html PUBLIC &#8220;-//W3C//DTD HTML 4.01//EN&#8220; &#8220;<a
            href="http://www.w3.org/TR/html4/strict.dtd">www.w3.org/TR/html4/strict.dtd</a>&#8220;>
            <html lang=&#8217;en&#8217;>
            </p>
            <pre>&lt;head&gt;&#x000A;  &lt;title&gt;Methods [RDoc Documentation]&lt;/title&gt;&#x000A;  &lt;meta content='text/html; charset=UTF-8' http-equiv='Content-Type'&gt;&#x000A;  &lt;link href='rdoc-style.css' media='screen' rel='stylesheet' type='text/css'&gt;&#x000A;  &lt;base target='docwin'&gt;&#x000A;&lt;/head&gt;&#x000A;&lt;body class='list'&gt;&#x000A;  &lt;div id='index'&gt;&#x000A;    &lt;h1&gt;Methods&lt;/h1&gt;&#x000A;    &lt;script type='text/javascript'&gt;&#x000A;      /*  Prototype JavaScript framework, version 1.6.0.3&#x000A;       *  (c) 2005-2008 Sam Stephenson&#x000A;       *&#x000A;       *  Prototype is freely distributable under the terms of an MIT-style license.&#x000A;       *  For details, see the Prototype web site: http://www.prototypejs.org/&#x000A;       *&#x000A;       *--------------------------------------------------------------------------*/&#x000A;&#x000A;      var Prototype = {&#x000A;        Version: '1.6.0.3',&#x000A;&#x000A;        Browser: {&#x000A;          IE:     !!(window.attachEvent &amp;&amp;&#x000A;            navigator.userAgent.indexOf('Opera') === -1),&#x000A;          Opera:  navigator.userAgent.indexOf('Opera') &gt; -1,&#x000A;          WebKit: navigator.userAgent.indexOf('AppleWebKit/') &gt; -1,&#x000A;          Gecko:  navigator.userAgent.indexOf('Gecko') &gt; -1 &amp;&amp;&#x000A;            navigator.userAgent.indexOf('KHTML') === -1,&#x000A;          MobileSafari: !!navigator.userAgent.match(/Apple.*Mobile.*Safari/)&#x000A;        },&#x000A;&#x000A;        BrowserFeatures: {&#x000A;          XPath: !!document.evaluate,&#x000A;          SelectorsAPI: !!document.querySelector,&#x000A;          ElementExtensions: !!window.HTMLElement,&#x000A;          SpecificElementExtensions:&#x000A;            document.createElement('div')['__proto__'] &amp;&amp;&#x000A;            document.createElement('div')['__proto__'] !==&#x000A;              document.createElement('form')['__proto__']&#x000A;        },&#x000A;&#x000A;        ScriptFragment: '&lt;script[^&gt;]*&gt;([\\S\\s]*?)&lt;\/script&gt;',&#x000A;        JSONFilter: /^\/\*-secure-([\s\S]*)\*\/\s*$/,&#x000A;&#x000A;        emptyFunction: function() { },&#x000A;        K: function(x) { return x }&#x000A;      };&#x000A;&#x000A;      if (Prototype.Browser.MobileSafari)&#x000A;        Prototype.BrowserFeatures.SpecificElementExtensions = false;&#x000A;&#x000A;      /* Based on Alex Arnell's inheritance implementation. */&#x000A;      var Class = {&#x000A;        create: function() {&#x000A;          var parent = null, properties = $A(arguments);&#x000A;          if (Object.isFunction(properties[0]))&#x000A;            parent = properties.shift();&#x000A;&#x000A;          function klass() {&#x000A;            this.initialize.apply(this, arguments);&#x000A;          }&#x000A;&#x000A;          Object.extend(klass, Class.Methods);&#x000A;          klass.superclass = parent;&#x000A;          klass.subclasses = [];&#x000A;&#x000A;          if (parent) {&#x000A;            var subclass = function() { };&#x000A;            subclass.prototype = parent.prototype;&#x000A;            klass.prototype = new subclass;&#x000A;            parent.subclasses.push(klass);&#x000A;          }&#x000A;&#x000A;          for (var i = 0; i &lt; properties.length; i++)&#x000A;            klass.addMethods(properties[i]);&#x000A;&#x000A;          if (!klass.prototype.initialize)&#x000A;            klass.prototype.initialize = Prototype.emptyFunction;&#x000A;&#x000A;          klass.prototype.constructor = klass;&#x000A;&#x000A;          return klass;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Class.Methods = {&#x000A;        addMethods: function(source) {&#x000A;          var ancestor   = this.superclass &amp;&amp; this.superclass.prototype;&#x000A;          var properties = Object.keys(source);&#x000A;&#x000A;          if (!Object.keys({ toString: true }).length)&#x000A;            properties.push(&quot;toString&quot;, &quot;valueOf&quot;);&#x000A;&#x000A;          for (var i = 0, length = properties.length; i &lt; length; i++) {&#x000A;            var property = properties[i], value = source[property];&#x000A;            if (ancestor &amp;&amp; Object.isFunction(value) &amp;&amp;&#x000A;                value.argumentNames().first() == &quot;$super&quot;) {&#x000A;              var method = value;&#x000A;              value = (function(m) {&#x000A;                return function() { return ancestor[m].apply(this, arguments) };&#x000A;              })(property).wrap(method);&#x000A;&#x000A;              value.valueOf = method.valueOf.bind(method);&#x000A;              value.toString = method.toString.bind(method);&#x000A;            }&#x000A;            this.prototype[property] = value;&#x000A;          }&#x000A;&#x000A;          return this;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      var Abstract = { };&#x000A;&#x000A;      Object.extend = function(destination, source) {&#x000A;        for (var property in source)&#x000A;          destination[property] = source[property];&#x000A;        return destination;&#x000A;      };&#x000A;&#x000A;      Object.extend(Object, {&#x000A;        inspect: function(object) {&#x000A;          try {&#x000A;            if (Object.isUndefined(object)) return 'undefined';&#x000A;            if (object === null) return 'null';&#x000A;            return object.inspect ? object.inspect() : String(object);&#x000A;          } catch (e) {&#x000A;            if (e instanceof RangeError) return '...';&#x000A;            throw e;&#x000A;          }&#x000A;        },&#x000A;&#x000A;        toJSON: function(object) {&#x000A;          var type = typeof object;&#x000A;          switch (type) {&#x000A;            case 'undefined':&#x000A;            case 'function':&#x000A;            case 'unknown': return;&#x000A;            case 'boolean': return object.toString();&#x000A;          }&#x000A;&#x000A;          if (object === null) return 'null';&#x000A;          if (object.toJSON) return object.toJSON();&#x000A;          if (Object.isElement(object)) return;&#x000A;&#x000A;          var results = [];&#x000A;          for (var property in object) {&#x000A;            var value = Object.toJSON(object[property]);&#x000A;            if (!Object.isUndefined(value))&#x000A;              results.push(property.toJSON() + ': ' + value);&#x000A;          }&#x000A;&#x000A;          return '{' + results.join(', ') + '}';&#x000A;        },&#x000A;&#x000A;        toQueryString: function(object) {&#x000A;          return $H(object).toQueryString();&#x000A;        },&#x000A;&#x000A;        toHTML: function(object) {&#x000A;          return object &amp;&amp; object.toHTML ? object.toHTML() : String.interpret(object);&#x000A;        },&#x000A;&#x000A;        keys: function(object) {&#x000A;          var keys = [];&#x000A;          for (var property in object)&#x000A;            keys.push(property);&#x000A;          return keys;&#x000A;        },&#x000A;&#x000A;        values: function(object) {&#x000A;          var values = [];&#x000A;          for (var property in object)&#x000A;            values.push(object[property]);&#x000A;          return values;&#x000A;        },&#x000A;&#x000A;        clone: function(object) {&#x000A;          return Object.extend({ }, object);&#x000A;        },&#x000A;&#x000A;        isElement: function(object) {&#x000A;          return !!(object &amp;&amp; object.nodeType == 1);&#x000A;        },&#x000A;&#x000A;        isArray: function(object) {&#x000A;          return object != null &amp;&amp; typeof object == &quot;object&quot; &amp;&amp;&#x000A;            'splice' in object &amp;&amp; 'join' in object;&#x000A;        },&#x000A;&#x000A;        isHash: function(object) {&#x000A;          return object instanceof Hash;&#x000A;        },&#x000A;&#x000A;        isFunction: function(object) {&#x000A;          return typeof object == &quot;function&quot;;&#x000A;        },&#x000A;&#x000A;        isString: function(object) {&#x000A;          return typeof object == &quot;string&quot;;&#x000A;        },&#x000A;&#x000A;        isNumber: function(object) {&#x000A;          return typeof object == &quot;number&quot;;&#x000A;        },&#x000A;&#x000A;        isUndefined: function(object) {&#x000A;          return typeof object == &quot;undefined&quot;;&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Object.extend(Function.prototype, {&#x000A;        argumentNames: function() {&#x000A;          var names = this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1]&#x000A;            .replace(/\s+/g, '').split(',');&#x000A;          return names.length == 1 &amp;&amp; !names[0] ? [] : names;&#x000A;        },&#x000A;&#x000A;        bind: function() {&#x000A;          if (arguments.length &lt; 2 &amp;&amp; Object.isUndefined(arguments[0])) return this;&#x000A;          var __method = this, args = $A(arguments), object = args.shift();&#x000A;          return function() {&#x000A;            return __method.apply(object, args.concat($A(arguments)));&#x000A;          }&#x000A;        },&#x000A;&#x000A;        bindAsEventListener: function() {&#x000A;          var __method = this, args = $A(arguments), object = args.shift();&#x000A;          return function(event) {&#x000A;            return __method.apply(object, [event || window.event].concat(args));&#x000A;          }&#x000A;        },&#x000A;&#x000A;        curry: function() {&#x000A;          if (!arguments.length) return this;&#x000A;          var __method = this, args = $A(arguments);&#x000A;          return function() {&#x000A;            return __method.apply(this, args.concat($A(arguments)));&#x000A;          }&#x000A;        },&#x000A;&#x000A;        delay: function() {&#x000A;          var __method = this, args = $A(arguments), timeout = args.shift() * 1000;&#x000A;          return window.setTimeout(function() {&#x000A;            return __method.apply(__method, args);&#x000A;          }, timeout);&#x000A;        },&#x000A;&#x000A;        defer: function() {&#x000A;          var args = [0.01].concat($A(arguments));&#x000A;          return this.delay.apply(this, args);&#x000A;        },&#x000A;&#x000A;        wrap: function(wrapper) {&#x000A;          var __method = this;&#x000A;          return function() {&#x000A;            return wrapper.apply(this, [__method.bind(this)].concat($A(arguments)));&#x000A;          }&#x000A;        },&#x000A;&#x000A;        methodize: function() {&#x000A;          if (this._methodized) return this._methodized;&#x000A;          var __method = this;&#x000A;          return this._methodized = function() {&#x000A;            return __method.apply(null, [this].concat($A(arguments)));&#x000A;          };&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Date.prototype.toJSON = function() {&#x000A;        return '&quot;' + this.getUTCFullYear() + '-' +&#x000A;          (this.getUTCMonth() + 1).toPaddedString(2) + '-' +&#x000A;          this.getUTCDate().toPaddedString(2) + 'T' +&#x000A;          this.getUTCHours().toPaddedString(2) + ':' +&#x000A;          this.getUTCMinutes().toPaddedString(2) + ':' +&#x000A;          this.getUTCSeconds().toPaddedString(2) + 'Z&quot;';&#x000A;      };&#x000A;&#x000A;      var Try = {&#x000A;        these: function() {&#x000A;          var returnValue;&#x000A;&#x000A;          for (var i = 0, length = arguments.length; i &lt; length; i++) {&#x000A;            var lambda = arguments[i];&#x000A;            try {&#x000A;              returnValue = lambda();&#x000A;              break;&#x000A;            } catch (e) { }&#x000A;          }&#x000A;&#x000A;          return returnValue;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      RegExp.prototype.match = RegExp.prototype.test;&#x000A;&#x000A;      RegExp.escape = function(str) {&#x000A;        return String(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');&#x000A;      };&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      var PeriodicalExecuter = Class.create({&#x000A;        initialize: function(callback, frequency) {&#x000A;          this.callback = callback;&#x000A;          this.frequency = frequency;&#x000A;          this.currentlyExecuting = false;&#x000A;&#x000A;          this.registerCallback();&#x000A;        },&#x000A;&#x000A;        registerCallback: function() {&#x000A;          this.timer = setInterval(this.onTimerEvent.bind(this), this.frequency * 1000);&#x000A;        },&#x000A;&#x000A;        execute: function() {&#x000A;          this.callback(this);&#x000A;        },&#x000A;&#x000A;        stop: function() {&#x000A;          if (!this.timer) return;&#x000A;          clearInterval(this.timer);&#x000A;          this.timer = null;&#x000A;        },&#x000A;&#x000A;        onTimerEvent: function() {&#x000A;          if (!this.currentlyExecuting) {&#x000A;            try {&#x000A;              this.currentlyExecuting = true;&#x000A;              this.execute();&#x000A;            } finally {&#x000A;              this.currentlyExecuting = false;&#x000A;            }&#x000A;          }&#x000A;        }&#x000A;      });&#x000A;      Object.extend(String, {&#x000A;        interpret: function(value) {&#x000A;          return value == null ? '' : String(value);&#x000A;        },&#x000A;        specialChar: {&#x000A;          '\b': '\\b',&#x000A;          '\t': '\\t',&#x000A;          '\n': '\\n',&#x000A;          '\f': '\\f',&#x000A;          '\r': '\\r',&#x000A;          '\\': '\\\\'&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Object.extend(String.prototype, {&#x000A;        gsub: function(pattern, replacement) {&#x000A;          var result = '', source = this, match;&#x000A;          replacement = arguments.callee.prepareReplacement(replacement);&#x000A;&#x000A;          while (source.length &gt; 0) {&#x000A;            if (match = source.match(pattern)) {&#x000A;              result += source.slice(0, match.index);&#x000A;              result += String.interpret(replacement(match));&#x000A;              source  = source.slice(match.index + match[0].length);&#x000A;            } else {&#x000A;              result += source, source = '';&#x000A;            }&#x000A;          }&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        sub: function(pattern, replacement, count) {&#x000A;          replacement = this.gsub.prepareReplacement(replacement);&#x000A;          count = Object.isUndefined(count) ? 1 : count;&#x000A;&#x000A;          return this.gsub(pattern, function(match) {&#x000A;            if (--count &lt; 0) return match[0];&#x000A;            return replacement(match);&#x000A;          });&#x000A;        },&#x000A;&#x000A;        scan: function(pattern, iterator) {&#x000A;          this.gsub(pattern, iterator);&#x000A;          return String(this);&#x000A;        },&#x000A;&#x000A;        truncate: function(length, truncation) {&#x000A;          length = length || 30;&#x000A;          truncation = Object.isUndefined(truncation) ? '...' : truncation;&#x000A;          return this.length &gt; length ?&#x000A;            this.slice(0, length - truncation.length) + truncation : String(this);&#x000A;        },&#x000A;&#x000A;        strip: function() {&#x000A;          return this.replace(/^\s+/, '').replace(/\s+$/, '');&#x000A;        },&#x000A;&#x000A;        stripTags: function() {&#x000A;          return this.replace(/&lt;\/?[^&gt;]+&gt;/gi, '');&#x000A;        },&#x000A;&#x000A;        stripScripts: function() {&#x000A;          return this.replace(new RegExp(Prototype.ScriptFragment, 'img'), '');&#x000A;        },&#x000A;&#x000A;        extractScripts: function() {&#x000A;          var matchAll = new RegExp(Prototype.ScriptFragment, 'img');&#x000A;          var matchOne = new RegExp(Prototype.ScriptFragment, 'im');&#x000A;          return (this.match(matchAll) || []).map(function(scriptTag) {&#x000A;            return (scriptTag.match(matchOne) || ['', ''])[1];&#x000A;          });&#x000A;        },&#x000A;&#x000A;        evalScripts: function() {&#x000A;          return this.extractScripts().map(function(script) { return eval(script) });&#x000A;        },&#x000A;&#x000A;        escapeHTML: function() {&#x000A;          var self = arguments.callee;&#x000A;          self.text.data = this;&#x000A;          return self.div.innerHTML;&#x000A;        },&#x000A;&#x000A;        unescapeHTML: function() {&#x000A;          var div = new Element('div');&#x000A;          div.innerHTML = this.stripTags();&#x000A;          return div.childNodes[0] ? (div.childNodes.length &gt; 1 ?&#x000A;            $A(div.childNodes).inject('', function(memo, node) { return memo+node.nodeValue }) :&#x000A;            div.childNodes[0].nodeValue) : '';&#x000A;        },&#x000A;&#x000A;        toQueryParams: function(separator) {&#x000A;          var match = this.strip().match(/([^?#]*)(#.*)?$/);&#x000A;          if (!match) return { };&#x000A;&#x000A;          return match[1].split(separator || '&amp;').inject({ }, function(hash, pair) {&#x000A;            if ((pair = pair.split('='))[0]) {&#x000A;              var key = decodeURIComponent(pair.shift());&#x000A;              var value = pair.length &gt; 1 ? pair.join('=') : pair[0];&#x000A;              if (value != undefined) value = decodeURIComponent(value);&#x000A;&#x000A;              if (key in hash) {&#x000A;                if (!Object.isArray(hash[key])) hash[key] = [hash[key]];&#x000A;                hash[key].push(value);&#x000A;              }&#x000A;              else hash[key] = value;&#x000A;            }&#x000A;            return hash;&#x000A;          });&#x000A;        },&#x000A;&#x000A;        toArray: function() {&#x000A;          return this.split('');&#x000A;        },&#x000A;&#x000A;        succ: function() {&#x000A;          return this.slice(0, this.length - 1) +&#x000A;            String.fromCharCode(this.charCodeAt(this.length - 1) + 1);&#x000A;        },&#x000A;&#x000A;        times: function(count) {&#x000A;          return count &lt; 1 ? '' : new Array(count + 1).join(this);&#x000A;        },&#x000A;&#x000A;        camelize: function() {&#x000A;          var parts = this.split('-'), len = parts.length;&#x000A;          if (len == 1) return parts[0];&#x000A;&#x000A;          var camelized = this.charAt(0) == '-'&#x000A;            ? parts[0].charAt(0).toUpperCase() + parts[0].substring(1)&#x000A;            : parts[0];&#x000A;&#x000A;          for (var i = 1; i &lt; len; i++)&#x000A;            camelized += parts[i].charAt(0).toUpperCase() + parts[i].substring(1);&#x000A;&#x000A;          return camelized;&#x000A;        },&#x000A;&#x000A;        capitalize: function() {&#x000A;          return this.charAt(0).toUpperCase() + this.substring(1).toLowerCase();&#x000A;        },&#x000A;&#x000A;        underscore: function() {&#x000A;          return this.gsub(/::/, '/').gsub(/([A-Z]+)([A-Z][a-z])/,'#{1}_#{2}').gsub(/([a-z\d])([A-Z])/,'#{1}_#{2}').gsub(/-/,'_').toLowerCase();&#x000A;        },&#x000A;&#x000A;        dasherize: function() {&#x000A;          return this.gsub(/_/,'-');&#x000A;        },&#x000A;&#x000A;        inspect: function(useDoubleQuotes) {&#x000A;          var escapedString = this.gsub(/[\x00-\x1f\\]/, function(match) {&#x000A;            var character = String.specialChar[match[0]];&#x000A;            return character ? character : '\\u00' + match[0].charCodeAt().toPaddedString(2, 16);&#x000A;          });&#x000A;          if (useDoubleQuotes) return '&quot;' + escapedString.replace(/&quot;/g, '\\&quot;') + '&quot;';&#x000A;          return &quot;'&quot; + escapedString.replace(/'/g, '\\\'') + &quot;'&quot;;&#x000A;        },&#x000A;&#x000A;        toJSON: function() {&#x000A;          return this.inspect(true);&#x000A;        },&#x000A;&#x000A;        unfilterJSON: function(filter) {&#x000A;          return this.sub(filter || Prototype.JSONFilter, '#{1}');&#x000A;        },&#x000A;&#x000A;        isJSON: function() {&#x000A;          var str = this;&#x000A;          if (str.blank()) return false;&#x000A;          str = this.replace(/\\./g, '@').replace(/&quot;[^&quot;\\\n\r]*&quot;/g, '');&#x000A;          return (/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str);&#x000A;        },&#x000A;&#x000A;        evalJSON: function(sanitize) {&#x000A;          var json = this.unfilterJSON();&#x000A;          try {&#x000A;            if (!sanitize || json.isJSON()) return eval('(' + json + ')');&#x000A;          } catch (e) { }&#x000A;          throw new SyntaxError('Badly formed JSON string: ' + this.inspect());&#x000A;        },&#x000A;&#x000A;        include: function(pattern) {&#x000A;          return this.indexOf(pattern) &gt; -1;&#x000A;        },&#x000A;&#x000A;        startsWith: function(pattern) {&#x000A;          return this.indexOf(pattern) === 0;&#x000A;        },&#x000A;&#x000A;        endsWith: function(pattern) {&#x000A;          var d = this.length - pattern.length;&#x000A;          return d &gt;= 0 &amp;&amp; this.lastIndexOf(pattern) === d;&#x000A;        },&#x000A;&#x000A;        empty: function() {&#x000A;          return this == '';&#x000A;        },&#x000A;&#x000A;        blank: function() {&#x000A;          return /^\s*$/.test(this);&#x000A;        },&#x000A;&#x000A;        interpolate: function(object, pattern) {&#x000A;          return new Template(this, pattern).evaluate(object);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      if (Prototype.Browser.WebKit || Prototype.Browser.IE) Object.extend(String.prototype, {&#x000A;        escapeHTML: function() {&#x000A;          return this.replace(/&amp;/g,'&amp;amp;').replace(/&lt;/g,'&amp;lt;').replace(/&gt;/g,'&amp;gt;');&#x000A;        },&#x000A;        unescapeHTML: function() {&#x000A;          return this.stripTags().replace(/&amp;amp;/g,'&amp;').replace(/&amp;lt;/g,'&lt;').replace(/&amp;gt;/g,'&gt;');&#x000A;        }&#x000A;      });&#x000A;&#x000A;      String.prototype.gsub.prepareReplacement = function(replacement) {&#x000A;        if (Object.isFunction(replacement)) return replacement;&#x000A;        var template = new Template(replacement);&#x000A;        return function(match) { return template.evaluate(match) };&#x000A;      };&#x000A;&#x000A;      String.prototype.parseQuery = String.prototype.toQueryParams;&#x000A;&#x000A;      Object.extend(String.prototype.escapeHTML, {&#x000A;        div:  document.createElement('div'),&#x000A;        text: document.createTextNode('')&#x000A;      });&#x000A;&#x000A;      String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);&#x000A;&#x000A;      var Template = Class.create({&#x000A;        initialize: function(template, pattern) {&#x000A;          this.template = template.toString();&#x000A;          this.pattern = pattern || Template.Pattern;&#x000A;        },&#x000A;&#x000A;        evaluate: function(object) {&#x000A;          if (Object.isFunction(object.toTemplateReplacements))&#x000A;            object = object.toTemplateReplacements();&#x000A;&#x000A;          return this.template.gsub(this.pattern, function(match) {&#x000A;            if (object == null) return '';&#x000A;&#x000A;            var before = match[1] || '';&#x000A;            if (before == '\\') return match[2];&#x000A;&#x000A;            var ctx = object, expr = match[3];&#x000A;            var pattern = /^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;&#x000A;            match = pattern.exec(expr);&#x000A;            if (match == null) return before;&#x000A;&#x000A;            while (match != null) {&#x000A;              var comp = match[1].startsWith('[') ? match[2].gsub('\\\\]', ']') : match[1];&#x000A;              ctx = ctx[comp];&#x000A;              if (null == ctx || '' == match[3]) break;&#x000A;              expr = expr.substring('[' == match[3] ? match[1].length : match[0].length);&#x000A;              match = pattern.exec(expr);&#x000A;            }&#x000A;&#x000A;            return before + String.interpret(ctx);&#x000A;          });&#x000A;        }&#x000A;      });&#x000A;      Template.Pattern = /(^|.|\r|\n)(#\{(.*?)\})/;&#x000A;&#x000A;      var $break = { };&#x000A;&#x000A;      var Enumerable = {&#x000A;        each: function(iterator, context) {&#x000A;          var index = 0;&#x000A;          try {&#x000A;            this._each(function(value) {&#x000A;              iterator.call(context, value, index++);&#x000A;            });&#x000A;          } catch (e) {&#x000A;            if (e != $break) throw e;&#x000A;          }&#x000A;          return this;&#x000A;        },&#x000A;&#x000A;        eachSlice: function(number, iterator, context) {&#x000A;          var index = -number, slices = [], array = this.toArray();&#x000A;          if (number &lt; 1) return array;&#x000A;          while ((index += number) &lt; array.length)&#x000A;            slices.push(array.slice(index, index+number));&#x000A;          return slices.collect(iterator, context);&#x000A;        },&#x000A;&#x000A;        all: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var result = true;&#x000A;          this.each(function(value, index) {&#x000A;            result = result &amp;&amp; !!iterator.call(context, value, index);&#x000A;            if (!result) throw $break;&#x000A;          });&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        any: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var result = false;&#x000A;          this.each(function(value, index) {&#x000A;            if (result = !!iterator.call(context, value, index))&#x000A;              throw $break;&#x000A;          });&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        collect: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var results = [];&#x000A;          this.each(function(value, index) {&#x000A;            results.push(iterator.call(context, value, index));&#x000A;          });&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        detect: function(iterator, context) {&#x000A;          var result;&#x000A;          this.each(function(value, index) {&#x000A;            if (iterator.call(context, value, index)) {&#x000A;              result = value;&#x000A;              throw $break;&#x000A;            }&#x000A;          });&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        findAll: function(iterator, context) {&#x000A;          var results = [];&#x000A;          this.each(function(value, index) {&#x000A;            if (iterator.call(context, value, index))&#x000A;              results.push(value);&#x000A;          });&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        grep: function(filter, iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var results = [];&#x000A;&#x000A;          if (Object.isString(filter))&#x000A;            filter = new RegExp(filter);&#x000A;&#x000A;          this.each(function(value, index) {&#x000A;            if (filter.match(value))&#x000A;              results.push(iterator.call(context, value, index));&#x000A;          });&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        include: function(object) {&#x000A;          if (Object.isFunction(this.indexOf))&#x000A;            if (this.indexOf(object) != -1) return true;&#x000A;&#x000A;          var found = false;&#x000A;          this.each(function(value) {&#x000A;            if (value == object) {&#x000A;              found = true;&#x000A;              throw $break;&#x000A;            }&#x000A;          });&#x000A;          return found;&#x000A;        },&#x000A;&#x000A;        inGroupsOf: function(number, fillWith) {&#x000A;          fillWith = Object.isUndefined(fillWith) ? null : fillWith;&#x000A;          return this.eachSlice(number, function(slice) {&#x000A;            while(slice.length &lt; number) slice.push(fillWith);&#x000A;            return slice;&#x000A;          });&#x000A;        },&#x000A;&#x000A;        inject: function(memo, iterator, context) {&#x000A;          this.each(function(value, index) {&#x000A;            memo = iterator.call(context, memo, value, index);&#x000A;          });&#x000A;          return memo;&#x000A;        },&#x000A;&#x000A;        invoke: function(method) {&#x000A;          var args = $A(arguments).slice(1);&#x000A;          return this.map(function(value) {&#x000A;            return value[method].apply(value, args);&#x000A;          });&#x000A;        },&#x000A;&#x000A;        max: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var result;&#x000A;          this.each(function(value, index) {&#x000A;            value = iterator.call(context, value, index);&#x000A;            if (result == null || value &gt;= result)&#x000A;              result = value;&#x000A;          });&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        min: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var result;&#x000A;          this.each(function(value, index) {&#x000A;            value = iterator.call(context, value, index);&#x000A;            if (result == null || value &lt; result)&#x000A;              result = value;&#x000A;          });&#x000A;          return result;&#x000A;        },&#x000A;&#x000A;        partition: function(iterator, context) {&#x000A;          iterator = iterator || Prototype.K;&#x000A;          var trues = [], falses = [];&#x000A;          this.each(function(value, index) {&#x000A;            (iterator.call(context, value, index) ?&#x000A;              trues : falses).push(value);&#x000A;          });&#x000A;          return [trues, falses];&#x000A;        },&#x000A;&#x000A;        pluck: function(property) {&#x000A;          var results = [];&#x000A;          this.each(function(value) {&#x000A;            results.push(value[property]);&#x000A;          });&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        reject: function(iterator, context) {&#x000A;          var results = [];&#x000A;          this.each(function(value, index) {&#x000A;            if (!iterator.call(context, value, index))&#x000A;              results.push(value);&#x000A;          });&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        sortBy: function(iterator, context) {&#x000A;          return this.map(function(value, index) {&#x000A;            return {&#x000A;              value: value,&#x000A;              criteria: iterator.call(context, value, index)&#x000A;            };&#x000A;          }).sort(function(left, right) {&#x000A;            var a = left.criteria, b = right.criteria;&#x000A;            return a &lt; b ? -1 : a &gt; b ? 1 : 0;&#x000A;          }).pluck('value');&#x000A;        },&#x000A;&#x000A;        toArray: function() {&#x000A;          return this.map();&#x000A;        },&#x000A;&#x000A;        zip: function() {&#x000A;          var iterator = Prototype.K, args = $A(arguments);&#x000A;          if (Object.isFunction(args.last()))&#x000A;            iterator = args.pop();&#x000A;&#x000A;          var collections = [this].concat(args).map($A);&#x000A;          return this.map(function(value, index) {&#x000A;            return iterator(collections.pluck(index));&#x000A;          });&#x000A;        },&#x000A;&#x000A;        size: function() {&#x000A;          return this.toArray().length;&#x000A;        },&#x000A;&#x000A;        inspect: function() {&#x000A;          return '#&lt;Enumerable:' + this.toArray().inspect() + '&gt;';&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Object.extend(Enumerable, {&#x000A;        map:     Enumerable.collect,&#x000A;        find:    Enumerable.detect,&#x000A;        select:  Enumerable.findAll,&#x000A;        filter:  Enumerable.findAll,&#x000A;        member:  Enumerable.include,&#x000A;        entries: Enumerable.toArray,&#x000A;        every:   Enumerable.all,&#x000A;        some:    Enumerable.any&#x000A;      });&#x000A;      function $A(iterable) {&#x000A;        if (!iterable) return [];&#x000A;        if (iterable.toArray) return iterable.toArray();&#x000A;        var length = iterable.length || 0, results = new Array(length);&#x000A;        while (length--) results[length] = iterable[length];&#x000A;        return results;&#x000A;      }&#x000A;&#x000A;      if (Prototype.Browser.WebKit) {&#x000A;        $A = function(iterable) {&#x000A;          if (!iterable) return [];&#x000A;          // In Safari, only use the `toArray` method if it's not a NodeList.&#x000A;          // A NodeList is a function, has an function `item` property, and a numeric&#x000A;          // `length` property. Adapted from Google Doctype.&#x000A;          if (!(typeof iterable === 'function' &amp;&amp; typeof iterable.length ===&#x000A;              'number' &amp;&amp; typeof iterable.item === 'function') &amp;&amp; iterable.toArray)&#x000A;            return iterable.toArray();&#x000A;          var length = iterable.length || 0, results = new Array(length);&#x000A;          while (length--) results[length] = iterable[length];&#x000A;          return results;&#x000A;        };&#x000A;      }&#x000A;&#x000A;      Array.from = $A;&#x000A;&#x000A;      Object.extend(Array.prototype, Enumerable);&#x000A;&#x000A;      if (!Array.prototype._reverse) Array.prototype._reverse = Array.prototype.reverse;&#x000A;&#x000A;      Object.extend(Array.prototype, {&#x000A;        _each: function(iterator) {&#x000A;          for (var i = 0, length = this.length; i &lt; length; i++)&#x000A;            iterator(this[i]);&#x000A;        },&#x000A;&#x000A;        clear: function() {&#x000A;          this.length = 0;&#x000A;          return this;&#x000A;        },&#x000A;&#x000A;        first: function() {&#x000A;          return this[0];&#x000A;        },&#x000A;&#x000A;        last: function() {&#x000A;          return this[this.length - 1];&#x000A;        },&#x000A;&#x000A;        compact: function() {&#x000A;          return this.select(function(value) {&#x000A;            return value != null;&#x000A;          });&#x000A;        },&#x000A;&#x000A;        flatten: function() {&#x000A;          return this.inject([], function(array, value) {&#x000A;            return array.concat(Object.isArray(value) ?&#x000A;              value.flatten() : [value]);&#x000A;          });&#x000A;        },&#x000A;&#x000A;        without: function() {&#x000A;          var values = $A(arguments);&#x000A;          return this.select(function(value) {&#x000A;            return !values.include(value);&#x000A;          });&#x000A;        },&#x000A;&#x000A;        reverse: function(inline) {&#x000A;          return (inline !== false ? this : this.toArray())._reverse();&#x000A;        },&#x000A;&#x000A;        reduce: function() {&#x000A;          return this.length &gt; 1 ? this : this[0];&#x000A;        },&#x000A;&#x000A;        uniq: function(sorted) {&#x000A;          return this.inject([], function(array, value, index) {&#x000A;            if (0 == index || (sorted ? array.last() != value : !array.include(value)))&#x000A;              array.push(value);&#x000A;            return array;&#x000A;          });&#x000A;        },&#x000A;&#x000A;        intersect: function(array) {&#x000A;          return this.uniq().findAll(function(item) {&#x000A;            return array.detect(function(value) { return item === value });&#x000A;          });&#x000A;        },&#x000A;&#x000A;        clone: function() {&#x000A;          return [].concat(this);&#x000A;        },&#x000A;&#x000A;        size: function() {&#x000A;          return this.length;&#x000A;        },&#x000A;&#x000A;        inspect: function() {&#x000A;          return '[' + this.map(Object.inspect).join(', ') + ']';&#x000A;        },&#x000A;&#x000A;        toJSON: function() {&#x000A;          var results = [];&#x000A;          this.each(function(object) {&#x000A;            var value = Object.toJSON(object);&#x000A;            if (!Object.isUndefined(value)) results.push(value);&#x000A;          });&#x000A;          return '[' + results.join(', ') + ']';&#x000A;        }&#x000A;      });&#x000A;&#x000A;      // use native browser JS 1.6 implementation if available&#x000A;      if (Object.isFunction(Array.prototype.forEach))&#x000A;        Array.prototype._each = Array.prototype.forEach;&#x000A;&#x000A;      if (!Array.prototype.indexOf) Array.prototype.indexOf = function(item, i) {&#x000A;        i || (i = 0);&#x000A;        var length = this.length;&#x000A;        if (i &lt; 0) i = length + i;&#x000A;        for (; i &lt; length; i++)&#x000A;          if (this[i] === item) return i;&#x000A;        return -1;&#x000A;      };&#x000A;&#x000A;      if (!Array.prototype.lastIndexOf) Array.prototype.lastIndexOf = function(item, i) {&#x000A;        i = isNaN(i) ? this.length : (i &lt; 0 ? this.length + i : i) + 1;&#x000A;        var n = this.slice(0, i).reverse().indexOf(item);&#x000A;        return (n &lt; 0) ? n : i - n - 1;&#x000A;      };&#x000A;&#x000A;      Array.prototype.toArray = Array.prototype.clone;&#x000A;&#x000A;      function $w(string) {&#x000A;        if (!Object.isString(string)) return [];&#x000A;        string = string.strip();&#x000A;        return string ? string.split(/\s+/) : [];&#x000A;      }&#x000A;&#x000A;      if (Prototype.Browser.Opera){&#x000A;        Array.prototype.concat = function() {&#x000A;          var array = [];&#x000A;          for (var i = 0, length = this.length; i &lt; length; i++) array.push(this[i]);&#x000A;          for (var i = 0, length = arguments.length; i &lt; length; i++) {&#x000A;            if (Object.isArray(arguments[i])) {&#x000A;              for (var j = 0, arrayLength = arguments[i].length; j &lt; arrayLength; j++)&#x000A;                array.push(arguments[i][j]);&#x000A;            } else {&#x000A;              array.push(arguments[i]);&#x000A;            }&#x000A;          }&#x000A;          return array;&#x000A;        };&#x000A;      }&#x000A;      Object.extend(Number.prototype, {&#x000A;        toColorPart: function() {&#x000A;          return this.toPaddedString(2, 16);&#x000A;        },&#x000A;&#x000A;        succ: function() {&#x000A;          return this + 1;&#x000A;        },&#x000A;&#x000A;        times: function(iterator, context) {&#x000A;          $R(0, this, true).each(iterator, context);&#x000A;          return this;&#x000A;        },&#x000A;&#x000A;        toPaddedString: function(length, radix) {&#x000A;          var string = this.toString(radix || 10);&#x000A;          return '0'.times(length - string.length) + string;&#x000A;        },&#x000A;&#x000A;        toJSON: function() {&#x000A;          return isFinite(this) ? this.toString() : 'null';&#x000A;        }&#x000A;      });&#x000A;&#x000A;      $w('abs round ceil floor').each(function(method){&#x000A;        Number.prototype[method] = Math[method].methodize();&#x000A;      });&#x000A;      function $H(object) {&#x000A;        return new Hash(object);&#x000A;      };&#x000A;&#x000A;      var Hash = Class.create(Enumerable, (function() {&#x000A;&#x000A;        function toQueryPair(key, value) {&#x000A;          if (Object.isUndefined(value)) return key;&#x000A;          return key + '=' + encodeURIComponent(String.interpret(value));&#x000A;        }&#x000A;&#x000A;        return {&#x000A;          initialize: function(object) {&#x000A;            this._object = Object.isHash(object) ? object.toObject() : Object.clone(object);&#x000A;          },&#x000A;&#x000A;          _each: function(iterator) {&#x000A;            for (var key in this._object) {&#x000A;              var value = this._object[key], pair = [key, value];&#x000A;              pair.key = key;&#x000A;              pair.value = value;&#x000A;              iterator(pair);&#x000A;            }&#x000A;          },&#x000A;&#x000A;          set: function(key, value) {&#x000A;            return this._object[key] = value;&#x000A;          },&#x000A;&#x000A;          get: function(key) {&#x000A;            // simulating poorly supported hasOwnProperty&#x000A;            if (this._object[key] !== Object.prototype[key])&#x000A;              return this._object[key];&#x000A;          },&#x000A;&#x000A;          unset: function(key) {&#x000A;            var value = this._object[key];&#x000A;            delete this._object[key];&#x000A;            return value;&#x000A;          },&#x000A;&#x000A;          toObject: function() {&#x000A;            return Object.clone(this._object);&#x000A;          },&#x000A;&#x000A;          keys: function() {&#x000A;            return this.pluck('key');&#x000A;          },&#x000A;&#x000A;          values: function() {&#x000A;            return this.pluck('value');&#x000A;          },&#x000A;&#x000A;          index: function(value) {&#x000A;            var match = this.detect(function(pair) {&#x000A;              return pair.value === value;&#x000A;            });&#x000A;            return match &amp;&amp; match.key;&#x000A;          },&#x000A;&#x000A;          merge: function(object) {&#x000A;            return this.clone().update(object);&#x000A;          },&#x000A;&#x000A;          update: function(object) {&#x000A;            return new Hash(object).inject(this, function(result, pair) {&#x000A;              result.set(pair.key, pair.value);&#x000A;              return result;&#x000A;            });&#x000A;          },&#x000A;&#x000A;          toQueryString: function() {&#x000A;            return this.inject([], function(results, pair) {&#x000A;              var key = encodeURIComponent(pair.key), values = pair.value;&#x000A;&#x000A;              if (values &amp;&amp; typeof values == 'object') {&#x000A;                if (Object.isArray(values))&#x000A;                  return results.concat(values.map(toQueryPair.curry(key)));&#x000A;              } else results.push(toQueryPair(key, values));&#x000A;              return results;&#x000A;            }).join('&amp;');&#x000A;          },&#x000A;&#x000A;          inspect: function() {&#x000A;            return '#&lt;Hash:{' + this.map(function(pair) {&#x000A;              return pair.map(Object.inspect).join(': ');&#x000A;            }).join(', ') + '}&gt;';&#x000A;          },&#x000A;&#x000A;          toJSON: function() {&#x000A;            return Object.toJSON(this.toObject());&#x000A;          },&#x000A;&#x000A;          clone: function() {&#x000A;            return new Hash(this);&#x000A;          }&#x000A;        }&#x000A;      })());&#x000A;&#x000A;      Hash.prototype.toTemplateReplacements = Hash.prototype.toObject;&#x000A;      Hash.from = $H;&#x000A;      var ObjectRange = Class.create(Enumerable, {&#x000A;        initialize: function(start, end, exclusive) {&#x000A;          this.start = start;&#x000A;          this.end = end;&#x000A;          this.exclusive = exclusive;&#x000A;        },&#x000A;&#x000A;        _each: function(iterator) {&#x000A;          var value = this.start;&#x000A;          while (this.include(value)) {&#x000A;            iterator(value);&#x000A;            value = value.succ();&#x000A;          }&#x000A;        },&#x000A;&#x000A;        include: function(value) {&#x000A;          if (value &lt; this.start)&#x000A;            return false;&#x000A;          if (this.exclusive)&#x000A;            return value &lt; this.end;&#x000A;          return value &lt;= this.end;&#x000A;        }&#x000A;      });&#x000A;&#x000A;      var $R = function(start, end, exclusive) {&#x000A;        return new ObjectRange(start, end, exclusive);&#x000A;      };&#x000A;&#x000A;      var Ajax = {&#x000A;        getTransport: function() {&#x000A;          return Try.these(&#x000A;            function() {return new XMLHttpRequest()},&#x000A;            function() {return new ActiveXObject('Msxml2.XMLHTTP')},&#x000A;            function() {return new ActiveXObject('Microsoft.XMLHTTP')}&#x000A;          ) || false;&#x000A;        },&#x000A;&#x000A;        activeRequestCount: 0&#x000A;      };&#x000A;&#x000A;      Ajax.Responders = {&#x000A;        responders: [],&#x000A;&#x000A;        _each: function(iterator) {&#x000A;          this.responders._each(iterator);&#x000A;        },&#x000A;&#x000A;        register: function(responder) {&#x000A;          if (!this.include(responder))&#x000A;            this.responders.push(responder);&#x000A;        },&#x000A;&#x000A;        unregister: function(responder) {&#x000A;          this.responders = this.responders.without(responder);&#x000A;        },&#x000A;&#x000A;        dispatch: function(callback, request, transport, json) {&#x000A;          this.each(function(responder) {&#x000A;            if (Object.isFunction(responder[callback])) {&#x000A;              try {&#x000A;                responder[callback].apply(responder, [request, transport, json]);&#x000A;              } catch (e) { }&#x000A;            }&#x000A;          });&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Object.extend(Ajax.Responders, Enumerable);&#x000A;&#x000A;      Ajax.Responders.register({&#x000A;        onCreate:   function() { Ajax.activeRequestCount++ },&#x000A;        onComplete: function() { Ajax.activeRequestCount-- }&#x000A;      });&#x000A;&#x000A;      Ajax.Base = Class.create({&#x000A;        initialize: function(options) {&#x000A;          this.options = {&#x000A;            method:       'post',&#x000A;            asynchronous: true,&#x000A;            contentType:  'application/x-www-form-urlencoded',&#x000A;            encoding:     'UTF-8',&#x000A;            parameters:   '',&#x000A;            evalJSON:     true,&#x000A;            evalJS:       true&#x000A;          };&#x000A;          Object.extend(this.options, options || { });&#x000A;&#x000A;          this.options.method = this.options.method.toLowerCase();&#x000A;&#x000A;          if (Object.isString(this.options.parameters))&#x000A;            this.options.parameters = this.options.parameters.toQueryParams();&#x000A;          else if (Object.isHash(this.options.parameters))&#x000A;            this.options.parameters = this.options.parameters.toObject();&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Ajax.Request = Class.create(Ajax.Base, {&#x000A;        _complete: false,&#x000A;&#x000A;        initialize: function($super, url, options) {&#x000A;          $super(options);&#x000A;          this.transport = Ajax.getTransport();&#x000A;          this.request(url);&#x000A;        },&#x000A;&#x000A;        request: function(url) {&#x000A;          this.url = url;&#x000A;          this.method = this.options.method;&#x000A;          var params = Object.clone(this.options.parameters);&#x000A;&#x000A;          if (!['get', 'post'].include(this.method)) {&#x000A;            // simulate other verbs over post&#x000A;            params['_method'] = this.method;&#x000A;            this.method = 'post';&#x000A;          }&#x000A;&#x000A;          this.parameters = params;&#x000A;&#x000A;          if (params = Object.toQueryString(params)) {&#x000A;            // when GET, append parameters to URL&#x000A;            if (this.method == 'get')&#x000A;              this.url += (this.url.include('?') ? '&amp;' : '?') + params;&#x000A;            else if (/Konqueror|Safari|KHTML/.test(navigator.userAgent))&#x000A;              params += '&amp;_=';&#x000A;          }&#x000A;&#x000A;          try {&#x000A;            var response = new Ajax.Response(this);&#x000A;            if (this.options.onCreate) this.options.onCreate(response);&#x000A;            Ajax.Responders.dispatch('onCreate', this, response);&#x000A;&#x000A;            this.transport.open(this.method.toUpperCase(), this.url,&#x000A;              this.options.asynchronous);&#x000A;&#x000A;            if (this.options.asynchronous) this.respondToReadyState.bind(this).defer(1);&#x000A;&#x000A;            this.transport.onreadystatechange = this.onStateChange.bind(this);&#x000A;            this.setRequestHeaders();&#x000A;&#x000A;            this.body = this.method == 'post' ? (this.options.postBody || params) : null;&#x000A;            this.transport.send(this.body);&#x000A;&#x000A;            /* Force Firefox to handle ready state 4 for synchronous requests */&#x000A;            if (!this.options.asynchronous &amp;&amp; this.transport.overrideMimeType)&#x000A;              this.onStateChange();&#x000A;&#x000A;          }&#x000A;          catch (e) {&#x000A;            this.dispatchException(e);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        onStateChange: function() {&#x000A;          var readyState = this.transport.readyState;&#x000A;          if (readyState &gt; 1 &amp;&amp; !((readyState == 4) &amp;&amp; this._complete))&#x000A;            this.respondToReadyState(this.transport.readyState);&#x000A;        },&#x000A;&#x000A;        setRequestHeaders: function() {&#x000A;          var headers = {&#x000A;            'X-Requested-With': 'XMLHttpRequest',&#x000A;            'X-Prototype-Version': Prototype.Version,&#x000A;            'Accept': 'text/javascript, text/html, application/xml, text/xml, */*'&#x000A;          };&#x000A;&#x000A;          if (this.method == 'post') {&#x000A;            headers['Content-type'] = this.options.contentType +&#x000A;              (this.options.encoding ? '; charset=' + this.options.encoding : '');&#x000A;&#x000A;            /* Force &quot;Connection: close&quot; for older Mozilla browsers to work&#x000A;             * around a bug where XMLHttpRequest sends an incorrect&#x000A;             * Content-length header. See Mozilla Bugzilla #246651.&#x000A;             */&#x000A;            if (this.transport.overrideMimeType &amp;&amp;&#x000A;                (navigator.userAgent.match(/Gecko\/(\d{4})/) || [0,2005])[1] &lt; 2005)&#x000A;                  headers['Connection'] = 'close';&#x000A;          }&#x000A;&#x000A;          // user-defined headers&#x000A;          if (typeof this.options.requestHeaders == 'object') {&#x000A;            var extras = this.options.requestHeaders;&#x000A;&#x000A;            if (Object.isFunction(extras.push))&#x000A;              for (var i = 0, length = extras.length; i &lt; length; i += 2)&#x000A;                headers[extras[i]] = extras[i+1];&#x000A;            else&#x000A;              $H(extras).each(function(pair) { headers[pair.key] = pair.value });&#x000A;          }&#x000A;&#x000A;          for (var name in headers)&#x000A;            this.transport.setRequestHeader(name, headers[name]);&#x000A;        },&#x000A;&#x000A;        success: function() {&#x000A;          var status = this.getStatus();&#x000A;          return !status || (status &gt;= 200 &amp;&amp; status &lt; 300);&#x000A;        },&#x000A;&#x000A;        getStatus: function() {&#x000A;          try {&#x000A;            return this.transport.status || 0;&#x000A;          } catch (e) { return 0 }&#x000A;        },&#x000A;&#x000A;        respondToReadyState: function(readyState) {&#x000A;          var state = Ajax.Request.Events[readyState], response = new Ajax.Response(this);&#x000A;&#x000A;          if (state == 'Complete') {&#x000A;            try {&#x000A;              this._complete = true;&#x000A;              (this.options['on' + response.status]&#x000A;               || this.options['on' + (this.success() ? 'Success' : 'Failure')]&#x000A;               || Prototype.emptyFunction)(response, response.headerJSON);&#x000A;            } catch (e) {&#x000A;              this.dispatchException(e);&#x000A;            }&#x000A;&#x000A;            var contentType = response.getHeader('Content-type');&#x000A;            if (this.options.evalJS == 'force'&#x000A;                || (this.options.evalJS &amp;&amp; this.isSameOrigin() &amp;&amp; contentType&#x000A;                &amp;&amp; contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i)))&#x000A;              this.evalResponse();&#x000A;          }&#x000A;&#x000A;          try {&#x000A;            (this.options['on' + state] || Prototype.emptyFunction)(response, response.headerJSON);&#x000A;            Ajax.Responders.dispatch('on' + state, this, response, response.headerJSON);&#x000A;          } catch (e) {&#x000A;            this.dispatchException(e);&#x000A;          }&#x000A;&#x000A;          if (state == 'Complete') {&#x000A;            // avoid memory leak in MSIE: clean up&#x000A;            this.transport.onreadystatechange = Prototype.emptyFunction;&#x000A;          }&#x000A;        },&#x000A;&#x000A;        isSameOrigin: function() {&#x000A;          var m = this.url.match(/^\s*https?:\/\/[^\/]*/);&#x000A;          return !m || (m[0] == '#{protocol}//#{domain}#{port}'.interpolate({&#x000A;            protocol: location.protocol,&#x000A;            domain: document.domain,&#x000A;            port: location.port ? ':' + location.port : ''&#x000A;          }));&#x000A;        },&#x000A;&#x000A;        getHeader: function(name) {&#x000A;          try {&#x000A;            return this.transport.getResponseHeader(name) || null;&#x000A;          } catch (e) { return null }&#x000A;        },&#x000A;&#x000A;        evalResponse: function() {&#x000A;          try {&#x000A;            return eval((this.transport.responseText || '').unfilterJSON());&#x000A;          } catch (e) {&#x000A;            this.dispatchException(e);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        dispatchException: function(exception) {&#x000A;          (this.options.onException || Prototype.emptyFunction)(this, exception);&#x000A;          Ajax.Responders.dispatch('onException', this, exception);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Ajax.Request.Events =&#x000A;        ['Uninitialized', 'Loading', 'Loaded', 'Interactive', 'Complete'];&#x000A;&#x000A;      Ajax.Response = Class.create({&#x000A;        initialize: function(request){&#x000A;          this.request = request;&#x000A;          var transport  = this.transport  = request.transport,&#x000A;              readyState = this.readyState = transport.readyState;&#x000A;&#x000A;          if((readyState &gt; 2 &amp;&amp; !Prototype.Browser.IE) || readyState == 4) {&#x000A;            this.status       = this.getStatus();&#x000A;            this.statusText   = this.getStatusText();&#x000A;            this.responseText = String.interpret(transport.responseText);&#x000A;            this.headerJSON   = this._getHeaderJSON();&#x000A;          }&#x000A;&#x000A;          if(readyState == 4) {&#x000A;            var xml = transport.responseXML;&#x000A;            this.responseXML  = Object.isUndefined(xml) ? null : xml;&#x000A;            this.responseJSON = this._getResponseJSON();&#x000A;          }&#x000A;        },&#x000A;&#x000A;        status:      0,&#x000A;        statusText: '',&#x000A;&#x000A;        getStatus: Ajax.Request.prototype.getStatus,&#x000A;&#x000A;        getStatusText: function() {&#x000A;          try {&#x000A;            return this.transport.statusText || '';&#x000A;          } catch (e) { return '' }&#x000A;        },&#x000A;&#x000A;        getHeader: Ajax.Request.prototype.getHeader,&#x000A;&#x000A;        getAllHeaders: function() {&#x000A;          try {&#x000A;            return this.getAllResponseHeaders();&#x000A;          } catch (e) { return null }&#x000A;        },&#x000A;&#x000A;        getResponseHeader: function(name) {&#x000A;          return this.transport.getResponseHeader(name);&#x000A;        },&#x000A;&#x000A;        getAllResponseHeaders: function() {&#x000A;          return this.transport.getAllResponseHeaders();&#x000A;        },&#x000A;&#x000A;        _getHeaderJSON: function() {&#x000A;          var json = this.getHeader('X-JSON');&#x000A;          if (!json) return null;&#x000A;          json = decodeURIComponent(escape(json));&#x000A;          try {&#x000A;            return json.evalJSON(this.request.options.sanitizeJSON ||&#x000A;              !this.request.isSameOrigin());&#x000A;          } catch (e) {&#x000A;            this.request.dispatchException(e);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        _getResponseJSON: function() {&#x000A;          var options = this.request.options;&#x000A;          if (!options.evalJSON || (options.evalJSON != 'force' &amp;&amp;&#x000A;            !(this.getHeader('Content-type') || '').include('application/json')) ||&#x000A;              this.responseText.blank())&#x000A;                return null;&#x000A;          try {&#x000A;            return this.responseText.evalJSON(options.sanitizeJSON ||&#x000A;              !this.request.isSameOrigin());&#x000A;          } catch (e) {&#x000A;            this.request.dispatchException(e);&#x000A;          }&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Ajax.Updater = Class.create(Ajax.Request, {&#x000A;        initialize: function($super, container, url, options) {&#x000A;          this.container = {&#x000A;            success: (container.success || container),&#x000A;            failure: (container.failure || (container.success ? null : container))&#x000A;          };&#x000A;&#x000A;          options = Object.clone(options);&#x000A;          var onComplete = options.onComplete;&#x000A;          options.onComplete = (function(response, json) {&#x000A;            this.updateContent(response.responseText);&#x000A;            if (Object.isFunction(onComplete)) onComplete(response, json);&#x000A;          }).bind(this);&#x000A;&#x000A;          $super(url, options);&#x000A;        },&#x000A;&#x000A;        updateContent: function(responseText) {&#x000A;          var receiver = this.container[this.success() ? 'success' : 'failure'],&#x000A;              options = this.options;&#x000A;&#x000A;          if (!options.evalScripts) responseText = responseText.stripScripts();&#x000A;&#x000A;          if (receiver = $(receiver)) {&#x000A;            if (options.insertion) {&#x000A;              if (Object.isString(options.insertion)) {&#x000A;                var insertion = { }; insertion[options.insertion] = responseText;&#x000A;                receiver.insert(insertion);&#x000A;              }&#x000A;              else options.insertion(receiver, responseText);&#x000A;            }&#x000A;            else receiver.update(responseText);&#x000A;          }&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Ajax.PeriodicalUpdater = Class.create(Ajax.Base, {&#x000A;        initialize: function($super, container, url, options) {&#x000A;          $super(options);&#x000A;          this.onComplete = this.options.onComplete;&#x000A;&#x000A;          this.frequency = (this.options.frequency || 2);&#x000A;          this.decay = (this.options.decay || 1);&#x000A;&#x000A;          this.updater = { };&#x000A;          this.container = container;&#x000A;          this.url = url;&#x000A;&#x000A;          this.start();&#x000A;        },&#x000A;&#x000A;        start: function() {&#x000A;          this.options.onComplete = this.updateComplete.bind(this);&#x000A;          this.onTimerEvent();&#x000A;        },&#x000A;&#x000A;        stop: function() {&#x000A;          this.updater.options.onComplete = undefined;&#x000A;          clearTimeout(this.timer);&#x000A;          (this.onComplete || Prototype.emptyFunction).apply(this, arguments);&#x000A;        },&#x000A;&#x000A;        updateComplete: function(response) {&#x000A;          if (this.options.decay) {&#x000A;            this.decay = (response.responseText == this.lastText ?&#x000A;              this.decay * this.options.decay : 1);&#x000A;&#x000A;            this.lastText = response.responseText;&#x000A;          }&#x000A;          this.timer = this.onTimerEvent.bind(this).delay(this.decay * this.frequency);&#x000A;        },&#x000A;&#x000A;        onTimerEvent: function() {&#x000A;          this.updater = new Ajax.Updater(this.container, this.url, this.options);&#x000A;        }&#x000A;      });&#x000A;      function $(element) {&#x000A;        if (arguments.length &gt; 1) {&#x000A;          for (var i = 0, elements = [], length = arguments.length; i &lt; length; i++)&#x000A;            elements.push($(arguments[i]));&#x000A;          return elements;&#x000A;        }&#x000A;        if (Object.isString(element))&#x000A;          element = document.getElementById(element);&#x000A;        return Element.extend(element);&#x000A;      }&#x000A;&#x000A;      if (Prototype.BrowserFeatures.XPath) {&#x000A;        document._getElementsByXPath = function(expression, parentElement) {&#x000A;          var results = [];&#x000A;          var query = document.evaluate(expression, $(parentElement) || document,&#x000A;            null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);&#x000A;          for (var i = 0, length = query.snapshotLength; i &lt; length; i++)&#x000A;            results.push(Element.extend(query.snapshotItem(i)));&#x000A;          return results;&#x000A;        };&#x000A;      }&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      if (!window.Node) var Node = { };&#x000A;&#x000A;      if (!Node.ELEMENT_NODE) {&#x000A;        // DOM level 2 ECMAScript Language Binding&#x000A;        Object.extend(Node, {&#x000A;          ELEMENT_NODE: 1,&#x000A;          ATTRIBUTE_NODE: 2,&#x000A;          TEXT_NODE: 3,&#x000A;          CDATA_SECTION_NODE: 4,&#x000A;          ENTITY_REFERENCE_NODE: 5,&#x000A;          ENTITY_NODE: 6,&#x000A;          PROCESSING_INSTRUCTION_NODE: 7,&#x000A;          COMMENT_NODE: 8,&#x000A;          DOCUMENT_NODE: 9,&#x000A;          DOCUMENT_TYPE_NODE: 10,&#x000A;          DOCUMENT_FRAGMENT_NODE: 11,&#x000A;          NOTATION_NODE: 12&#x000A;        });&#x000A;      }&#x000A;&#x000A;      (function() {&#x000A;        var element = this.Element;&#x000A;        this.Element = function(tagName, attributes) {&#x000A;          attributes = attributes || { };&#x000A;          tagName = tagName.toLowerCase();&#x000A;          var cache = Element.cache;&#x000A;          if (Prototype.Browser.IE &amp;&amp; attributes.name) {&#x000A;            tagName = '&lt;' + tagName + ' name=&quot;' + attributes.name + '&quot;&gt;';&#x000A;            delete attributes.name;&#x000A;            return Element.writeAttribute(document.createElement(tagName), attributes);&#x000A;          }&#x000A;          if (!cache[tagName]) cache[tagName] = Element.extend(document.createElement(tagName));&#x000A;          return Element.writeAttribute(cache[tagName].cloneNode(false), attributes);&#x000A;        };&#x000A;        Object.extend(this.Element, element || { });&#x000A;        if (element) this.Element.prototype = element.prototype;&#x000A;      }).call(window);&#x000A;&#x000A;      Element.cache = { };&#x000A;&#x000A;      Element.Methods = {&#x000A;        visible: function(element) {&#x000A;          return $(element).style.display != 'none';&#x000A;        },&#x000A;&#x000A;        toggle: function(element) {&#x000A;          element = $(element);&#x000A;          Element[Element.visible(element) ? 'hide' : 'show'](element);&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        hide: function(element) {&#x000A;          element = $(element);&#x000A;          element.style.display = 'none';&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        show: function(element) {&#x000A;          element = $(element);&#x000A;          element.style.display = '';&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        remove: function(element) {&#x000A;          element = $(element);&#x000A;          element.parentNode.removeChild(element);&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        update: function(element, content) {&#x000A;          element = $(element);&#x000A;          if (content &amp;&amp; content.toElement) content = content.toElement();&#x000A;          if (Object.isElement(content)) return element.update().insert(content);&#x000A;          content = Object.toHTML(content);&#x000A;          element.innerHTML = content.stripScripts();&#x000A;          content.evalScripts.bind(content).defer();&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        replace: function(element, content) {&#x000A;          element = $(element);&#x000A;          if (content &amp;&amp; content.toElement) content = content.toElement();&#x000A;          else if (!Object.isElement(content)) {&#x000A;            content = Object.toHTML(content);&#x000A;            var range = element.ownerDocument.createRange();&#x000A;            range.selectNode(element);&#x000A;            content.evalScripts.bind(content).defer();&#x000A;            content = range.createContextualFragment(content.stripScripts());&#x000A;          }&#x000A;          element.parentNode.replaceChild(content, element);&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        insert: function(element, insertions) {&#x000A;          element = $(element);&#x000A;&#x000A;          if (Object.isString(insertions) || Object.isNumber(insertions) ||&#x000A;              Object.isElement(insertions) || (insertions &amp;&amp; (insertions.toElement || insertions.toHTML)))&#x000A;                insertions = {bottom:insertions};&#x000A;&#x000A;          var content, insert, tagName, childNodes;&#x000A;&#x000A;          for (var position in insertions) {&#x000A;            content  = insertions[position];&#x000A;            position = position.toLowerCase();&#x000A;            insert = Element._insertionTranslations[position];&#x000A;&#x000A;            if (content &amp;&amp; content.toElement) content = content.toElement();&#x000A;            if (Object.isElement(content)) {&#x000A;              insert(element, content);&#x000A;              continue;&#x000A;            }&#x000A;&#x000A;            content = Object.toHTML(content);&#x000A;&#x000A;            tagName = ((position == 'before' || position == 'after')&#x000A;              ? element.parentNode : element).tagName.toUpperCase();&#x000A;&#x000A;            childNodes = Element._getContentFromAnonymousElement(tagName, content.stripScripts());&#x000A;&#x000A;            if (position == 'top' || position == 'after') childNodes.reverse();&#x000A;            childNodes.each(insert.curry(element));&#x000A;&#x000A;            content.evalScripts.bind(content).defer();&#x000A;          }&#x000A;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        wrap: function(element, wrapper, attributes) {&#x000A;          element = $(element);&#x000A;          if (Object.isElement(wrapper))&#x000A;            $(wrapper).writeAttribute(attributes || { });&#x000A;          else if (Object.isString(wrapper)) wrapper = new Element(wrapper, attributes);&#x000A;          else wrapper = new Element('div', wrapper);&#x000A;          if (element.parentNode)&#x000A;            element.parentNode.replaceChild(wrapper, element);&#x000A;          wrapper.appendChild(element);&#x000A;          return wrapper;&#x000A;        },&#x000A;&#x000A;        inspect: function(element) {&#x000A;          element = $(element);&#x000A;          var result = '&lt;' + element.tagName.toLowerCase();&#x000A;          $H({'id': 'id', 'className': 'class'}).each(function(pair) {&#x000A;            var property = pair.first(), attribute = pair.last();&#x000A;            var value = (element[property] || '').toString();&#x000A;            if (value) result += ' ' + attribute + '=' + value.inspect(true);&#x000A;          });&#x000A;          return result + '&gt;';&#x000A;        },&#x000A;&#x000A;        recursivelyCollect: function(element, property) {&#x000A;          element = $(element);&#x000A;          var elements = [];&#x000A;          while (element = element[property])&#x000A;            if (element.nodeType == 1)&#x000A;              elements.push(Element.extend(element));&#x000A;          return elements;&#x000A;        },&#x000A;&#x000A;        ancestors: function(element) {&#x000A;          return $(element).recursivelyCollect('parentNode');&#x000A;        },&#x000A;&#x000A;        descendants: function(element) {&#x000A;          return $(element).select(&quot;*&quot;);&#x000A;        },&#x000A;&#x000A;        firstDescendant: function(element) {&#x000A;          element = $(element).firstChild;&#x000A;          while (element &amp;&amp; element.nodeType != 1) element = element.nextSibling;&#x000A;          return $(element);&#x000A;        },&#x000A;&#x000A;        immediateDescendants: function(element) {&#x000A;          if (!(element = $(element).firstChild)) return [];&#x000A;          while (element &amp;&amp; element.nodeType != 1) element = element.nextSibling;&#x000A;          if (element) return [element].concat($(element).nextSiblings());&#x000A;          return [];&#x000A;        },&#x000A;&#x000A;        previousSiblings: function(element) {&#x000A;          return $(element).recursivelyCollect('previousSibling');&#x000A;        },&#x000A;&#x000A;        nextSiblings: function(element) {&#x000A;          return $(element).recursivelyCollect('nextSibling');&#x000A;        },&#x000A;&#x000A;        siblings: function(element) {&#x000A;          element = $(element);&#x000A;          return element.previousSiblings().reverse().concat(element.nextSiblings());&#x000A;        },&#x000A;&#x000A;        match: function(element, selector) {&#x000A;          if (Object.isString(selector))&#x000A;            selector = new Selector(selector);&#x000A;          return selector.match($(element));&#x000A;        },&#x000A;&#x000A;        up: function(element, expression, index) {&#x000A;          element = $(element);&#x000A;          if (arguments.length == 1) return $(element.parentNode);&#x000A;          var ancestors = element.ancestors();&#x000A;          return Object.isNumber(expression) ? ancestors[expression] :&#x000A;            Selector.findElement(ancestors, expression, index);&#x000A;        },&#x000A;&#x000A;        down: function(element, expression, index) {&#x000A;          element = $(element);&#x000A;          if (arguments.length == 1) return element.firstDescendant();&#x000A;          return Object.isNumber(expression) ? element.descendants()[expression] :&#x000A;            Element.select(element, expression)[index || 0];&#x000A;        },&#x000A;&#x000A;        previous: function(element, expression, index) {&#x000A;          element = $(element);&#x000A;          if (arguments.length == 1) return $(Selector.handlers.previousElementSibling(element));&#x000A;          var previousSiblings = element.previousSiblings();&#x000A;          return Object.isNumber(expression) ? previousSiblings[expression] :&#x000A;            Selector.findElement(previousSiblings, expression, index);&#x000A;        },&#x000A;&#x000A;        next: function(element, expression, index) {&#x000A;          element = $(element);&#x000A;          if (arguments.length == 1) return $(Selector.handlers.nextElementSibling(element));&#x000A;          var nextSiblings = element.nextSiblings();&#x000A;          return Object.isNumber(expression) ? nextSiblings[expression] :&#x000A;            Selector.findElement(nextSiblings, expression, index);&#x000A;        },&#x000A;&#x000A;        select: function() {&#x000A;          var args = $A(arguments), element = $(args.shift());&#x000A;          return Selector.findChildElements(element, args);&#x000A;        },&#x000A;&#x000A;        adjacent: function() {&#x000A;          var args = $A(arguments), element = $(args.shift());&#x000A;          return Selector.findChildElements(element.parentNode, args).without(element);&#x000A;        },&#x000A;&#x000A;        identify: function(element) {&#x000A;          element = $(element);&#x000A;          var id = element.readAttribute('id'), self = arguments.callee;&#x000A;          if (id) return id;&#x000A;          do { id = 'anonymous_element_' + self.counter++ } while ($(id));&#x000A;          element.writeAttribute('id', id);&#x000A;          return id;&#x000A;        },&#x000A;&#x000A;        readAttribute: function(element, name) {&#x000A;          element = $(element);&#x000A;          if (Prototype.Browser.IE) {&#x000A;            var t = Element._attributeTranslations.read;&#x000A;            if (t.values[name]) return t.values[name](element, name);&#x000A;            if (t.names[name]) name = t.names[name];&#x000A;            if (name.include(':')) {&#x000A;              return (!element.attributes || !element.attributes[name]) ? null :&#x000A;               element.attributes[name].value;&#x000A;            }&#x000A;          }&#x000A;          return element.getAttribute(name);&#x000A;        },&#x000A;&#x000A;        writeAttribute: function(element, name, value) {&#x000A;          element = $(element);&#x000A;          var attributes = { }, t = Element._attributeTranslations.write;&#x000A;&#x000A;          if (typeof name == 'object') attributes = name;&#x000A;          else attributes[name] = Object.isUndefined(value) ? true : value;&#x000A;&#x000A;          for (var attr in attributes) {&#x000A;            name = t.names[attr] || attr;&#x000A;            value = attributes[attr];&#x000A;            if (t.values[attr]) name = t.values[attr](element, value);&#x000A;            if (value === false || value === null)&#x000A;              element.removeAttribute(name);&#x000A;            else if (value === true)&#x000A;              element.setAttribute(name, name);&#x000A;            else element.setAttribute(name, value);&#x000A;          }&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        getHeight: function(element) {&#x000A;          return $(element).getDimensions().height;&#x000A;        },&#x000A;&#x000A;        getWidth: function(element) {&#x000A;          return $(element).getDimensions().width;&#x000A;        },&#x000A;&#x000A;        classNames: function(element) {&#x000A;          return new Element.ClassNames(element);&#x000A;        },&#x000A;&#x000A;        hasClassName: function(element, className) {&#x000A;          if (!(element = $(element))) return;&#x000A;          var elementClassName = element.className;&#x000A;          return (elementClassName.length &gt; 0 &amp;&amp; (elementClassName == className ||&#x000A;            new RegExp(&quot;(^|\\s)&quot; + className + &quot;(\\s|$)&quot;).test(elementClassName)));&#x000A;        },&#x000A;&#x000A;        addClassName: function(element, className) {&#x000A;          if (!(element = $(element))) return;&#x000A;          if (!element.hasClassName(className))&#x000A;            element.className += (element.className ? ' ' : '') + className;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        removeClassName: function(element, className) {&#x000A;          if (!(element = $(element))) return;&#x000A;          element.className = element.className.replace(&#x000A;            new RegExp(&quot;(^|\\s+)&quot; + className + &quot;(\\s+|$)&quot;), ' ').strip();&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        toggleClassName: function(element, className) {&#x000A;          if (!(element = $(element))) return;&#x000A;          return element[element.hasClassName(className) ?&#x000A;            'removeClassName' : 'addClassName'](className);&#x000A;        },&#x000A;&#x000A;        // removes whitespace-only text node children&#x000A;        cleanWhitespace: function(element) {&#x000A;          element = $(element);&#x000A;          var node = element.firstChild;&#x000A;          while (node) {&#x000A;            var nextNode = node.nextSibling;&#x000A;            if (node.nodeType == 3 &amp;&amp; !/\S/.test(node.nodeValue))&#x000A;              element.removeChild(node);&#x000A;            node = nextNode;&#x000A;          }&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        empty: function(element) {&#x000A;          return $(element).innerHTML.blank();&#x000A;        },&#x000A;&#x000A;        descendantOf: function(element, ancestor) {&#x000A;          element = $(element), ancestor = $(ancestor);&#x000A;&#x000A;          if (element.compareDocumentPosition)&#x000A;            return (element.compareDocumentPosition(ancestor) &amp; 8) === 8;&#x000A;&#x000A;          if (ancestor.contains)&#x000A;            return ancestor.contains(element) &amp;&amp; ancestor !== element;&#x000A;&#x000A;          while (element = element.parentNode)&#x000A;            if (element == ancestor) return true;&#x000A;&#x000A;          return false;&#x000A;        },&#x000A;&#x000A;        scrollTo: function(element) {&#x000A;          element = $(element);&#x000A;          var pos = element.cumulativeOffset();&#x000A;          window.scrollTo(pos[0], pos[1]);&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        getStyle: function(element, style) {&#x000A;          element = $(element);&#x000A;          style = style == 'float' ? 'cssFloat' : style.camelize();&#x000A;          var value = element.style[style];&#x000A;          if (!value || value == 'auto') {&#x000A;            var css = document.defaultView.getComputedStyle(element, null);&#x000A;            value = css ? css[style] : null;&#x000A;          }&#x000A;          if (style == 'opacity') return value ? parseFloat(value) : 1.0;&#x000A;          return value == 'auto' ? null : value;&#x000A;        },&#x000A;&#x000A;        getOpacity: function(element) {&#x000A;          return $(element).getStyle('opacity');&#x000A;        },&#x000A;&#x000A;        setStyle: function(element, styles) {&#x000A;          element = $(element);&#x000A;          var elementStyle = element.style, match;&#x000A;          if (Object.isString(styles)) {&#x000A;            element.style.cssText += ';' + styles;&#x000A;            return styles.include('opacity') ?&#x000A;              element.setOpacity(styles.match(/opacity:\s*(\d?\.?\d*)/)[1]) : element;&#x000A;          }&#x000A;          for (var property in styles)&#x000A;            if (property == 'opacity') element.setOpacity(styles[property]);&#x000A;            else&#x000A;              elementStyle[(property == 'float' || property == 'cssFloat') ?&#x000A;                (Object.isUndefined(elementStyle.styleFloat) ? 'cssFloat' : 'styleFloat') :&#x000A;                  property] = styles[property];&#x000A;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        setOpacity: function(element, value) {&#x000A;          element = $(element);&#x000A;          element.style.opacity = (value == 1 || value === '') ? '' :&#x000A;            (value &lt; 0.00001) ? 0 : value;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        getDimensions: function(element) {&#x000A;          element = $(element);&#x000A;          var display = element.getStyle('display');&#x000A;          if (display != 'none' &amp;&amp; display != null) // Safari bug&#x000A;            return {width: element.offsetWidth, height: element.offsetHeight};&#x000A;&#x000A;          // All *Width and *Height properties give 0 on elements with display none,&#x000A;          // so enable the element temporarily&#x000A;          var els = element.style;&#x000A;          var originalVisibility = els.visibility;&#x000A;          var originalPosition = els.position;&#x000A;          var originalDisplay = els.display;&#x000A;          els.visibility = 'hidden';&#x000A;          els.position = 'absolute';&#x000A;          els.display = 'block';&#x000A;          var originalWidth = element.clientWidth;&#x000A;          var originalHeight = element.clientHeight;&#x000A;          els.display = originalDisplay;&#x000A;          els.position = originalPosition;&#x000A;          els.visibility = originalVisibility;&#x000A;          return {width: originalWidth, height: originalHeight};&#x000A;        },&#x000A;&#x000A;        makePositioned: function(element) {&#x000A;          element = $(element);&#x000A;          var pos = Element.getStyle(element, 'position');&#x000A;          if (pos == 'static' || !pos) {&#x000A;            element._madePositioned = true;&#x000A;            element.style.position = 'relative';&#x000A;            // Opera returns the offset relative to the positioning context, when an&#x000A;            // element is position relative but top and left have not been defined&#x000A;            if (Prototype.Browser.Opera) {&#x000A;              element.style.top = 0;&#x000A;              element.style.left = 0;&#x000A;            }&#x000A;          }&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        undoPositioned: function(element) {&#x000A;          element = $(element);&#x000A;          if (element._madePositioned) {&#x000A;            element._madePositioned = undefined;&#x000A;            element.style.position =&#x000A;              element.style.top =&#x000A;              element.style.left =&#x000A;              element.style.bottom =&#x000A;              element.style.right = '';&#x000A;          }&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        makeClipping: function(element) {&#x000A;          element = $(element);&#x000A;          if (element._overflow) return element;&#x000A;          element._overflow = Element.getStyle(element, 'overflow') || 'auto';&#x000A;          if (element._overflow !== 'hidden')&#x000A;            element.style.overflow = 'hidden';&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        undoClipping: function(element) {&#x000A;          element = $(element);&#x000A;          if (!element._overflow) return element;&#x000A;          element.style.overflow = element._overflow == 'auto' ? '' : element._overflow;&#x000A;          element._overflow = null;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        cumulativeOffset: function(element) {&#x000A;          var valueT = 0, valueL = 0;&#x000A;          do {&#x000A;            valueT += element.offsetTop  || 0;&#x000A;            valueL += element.offsetLeft || 0;&#x000A;            element = element.offsetParent;&#x000A;          } while (element);&#x000A;          return Element._returnOffset(valueL, valueT);&#x000A;        },&#x000A;&#x000A;        positionedOffset: function(element) {&#x000A;          var valueT = 0, valueL = 0;&#x000A;          do {&#x000A;            valueT += element.offsetTop  || 0;&#x000A;            valueL += element.offsetLeft || 0;&#x000A;            element = element.offsetParent;&#x000A;            if (element) {&#x000A;              if (element.tagName.toUpperCase() == 'BODY') break;&#x000A;              var p = Element.getStyle(element, 'position');&#x000A;              if (p !== 'static') break;&#x000A;            }&#x000A;          } while (element);&#x000A;          return Element._returnOffset(valueL, valueT);&#x000A;        },&#x000A;&#x000A;        absolutize: function(element) {&#x000A;          element = $(element);&#x000A;          if (element.getStyle('position') == 'absolute') return element;&#x000A;          // Position.prepare(); // To be done manually by Scripty when it needs it.&#x000A;&#x000A;          var offsets = element.positionedOffset();&#x000A;          var top     = offsets[1];&#x000A;          var left    = offsets[0];&#x000A;          var width   = element.clientWidth;&#x000A;          var height  = element.clientHeight;&#x000A;&#x000A;          element._originalLeft   = left - parseFloat(element.style.left  || 0);&#x000A;          element._originalTop    = top  - parseFloat(element.style.top || 0);&#x000A;          element._originalWidth  = element.style.width;&#x000A;          element._originalHeight = element.style.height;&#x000A;&#x000A;          element.style.position = 'absolute';&#x000A;          element.style.top    = top + 'px';&#x000A;          element.style.left   = left + 'px';&#x000A;          element.style.width  = width + 'px';&#x000A;          element.style.height = height + 'px';&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        relativize: function(element) {&#x000A;          element = $(element);&#x000A;          if (element.getStyle('position') == 'relative') return element;&#x000A;          // Position.prepare(); // To be done manually by Scripty when it needs it.&#x000A;&#x000A;          element.style.position = 'relative';&#x000A;          var top  = parseFloat(element.style.top  || 0) - (element._originalTop || 0);&#x000A;          var left = parseFloat(element.style.left || 0) - (element._originalLeft || 0);&#x000A;&#x000A;          element.style.top    = top + 'px';&#x000A;          element.style.left   = left + 'px';&#x000A;          element.style.height = element._originalHeight;&#x000A;          element.style.width  = element._originalWidth;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        cumulativeScrollOffset: function(element) {&#x000A;          var valueT = 0, valueL = 0;&#x000A;          do {&#x000A;            valueT += element.scrollTop  || 0;&#x000A;            valueL += element.scrollLeft || 0;&#x000A;            element = element.parentNode;&#x000A;          } while (element);&#x000A;          return Element._returnOffset(valueL, valueT);&#x000A;        },&#x000A;&#x000A;        getOffsetParent: function(element) {&#x000A;          if (element.offsetParent) return $(element.offsetParent);&#x000A;          if (element == document.body) return $(element);&#x000A;&#x000A;          while ((element = element.parentNode) &amp;&amp; element != document.body)&#x000A;            if (Element.getStyle(element, 'position') != 'static')&#x000A;              return $(element);&#x000A;&#x000A;          return $(document.body);&#x000A;        },&#x000A;&#x000A;        viewportOffset: function(forElement) {&#x000A;          var valueT = 0, valueL = 0;&#x000A;&#x000A;          var element = forElement;&#x000A;          do {&#x000A;            valueT += element.offsetTop  || 0;&#x000A;            valueL += element.offsetLeft || 0;&#x000A;&#x000A;            // Safari fix&#x000A;            if (element.offsetParent == document.body &amp;&amp;&#x000A;              Element.getStyle(element, 'position') == 'absolute') break;&#x000A;&#x000A;          } while (element = element.offsetParent);&#x000A;&#x000A;          element = forElement;&#x000A;          do {&#x000A;            if (!Prototype.Browser.Opera || (element.tagName &amp;&amp; (element.tagName.toUpperCase() == 'BODY'))) {&#x000A;              valueT -= element.scrollTop  || 0;&#x000A;              valueL -= element.scrollLeft || 0;&#x000A;            }&#x000A;          } while (element = element.parentNode);&#x000A;&#x000A;          return Element._returnOffset(valueL, valueT);&#x000A;        },&#x000A;&#x000A;        clonePosition: function(element, source) {&#x000A;          var options = Object.extend({&#x000A;            setLeft:    true,&#x000A;            setTop:     true,&#x000A;            setWidth:   true,&#x000A;            setHeight:  true,&#x000A;            offsetTop:  0,&#x000A;            offsetLeft: 0&#x000A;          }, arguments[2] || { });&#x000A;&#x000A;          // find page position of source&#x000A;          source = $(source);&#x000A;          var p = source.viewportOffset();&#x000A;&#x000A;          // find coordinate system to use&#x000A;          element = $(element);&#x000A;          var delta = [0, 0];&#x000A;          var parent = null;&#x000A;          // delta [0,0] will do fine with position: fixed elements,&#x000A;          // position:absolute needs offsetParent deltas&#x000A;          if (Element.getStyle(element, 'position') == 'absolute') {&#x000A;            parent = element.getOffsetParent();&#x000A;            delta = parent.viewportOffset();&#x000A;          }&#x000A;&#x000A;          // correct by body offsets (fixes Safari)&#x000A;          if (parent == document.body) {&#x000A;            delta[0] -= document.body.offsetLeft;&#x000A;            delta[1] -= document.body.offsetTop;&#x000A;          }&#x000A;&#x000A;          // set position&#x000A;          if (options.setLeft)   element.style.left  = (p[0] - delta[0] + options.offsetLeft) + 'px';&#x000A;          if (options.setTop)    element.style.top   = (p[1] - delta[1] + options.offsetTop) + 'px';&#x000A;          if (options.setWidth)  element.style.width = source.offsetWidth + 'px';&#x000A;          if (options.setHeight) element.style.height = source.offsetHeight + 'px';&#x000A;          return element;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Element.Methods.identify.counter = 1;&#x000A;&#x000A;      Object.extend(Element.Methods, {&#x000A;        getElementsBySelector: Element.Methods.select,&#x000A;        childElements: Element.Methods.immediateDescendants&#x000A;      });&#x000A;&#x000A;      Element._attributeTranslations = {&#x000A;        write: {&#x000A;          names: {&#x000A;            className: 'class',&#x000A;            htmlFor:   'for'&#x000A;          },&#x000A;          values: { }&#x000A;        }&#x000A;      };&#x000A;&#x000A;      if (Prototype.Browser.Opera) {&#x000A;        Element.Methods.getStyle = Element.Methods.getStyle.wrap(&#x000A;          function(proceed, element, style) {&#x000A;            switch (style) {&#x000A;              case 'left': case 'top': case 'right': case 'bottom':&#x000A;                if (proceed(element, 'position') === 'static') return null;&#x000A;              case 'height': case 'width':&#x000A;                // returns '0px' for hidden elements; we want it to return null&#x000A;                if (!Element.visible(element)) return null;&#x000A;&#x000A;                // returns the border-box dimensions rather than the content-box&#x000A;                // dimensions, so we subtract padding and borders from the value&#x000A;                var dim = parseInt(proceed(element, style), 10);&#x000A;&#x000A;                if (dim !== element['offset' + style.capitalize()])&#x000A;                  return dim + 'px';&#x000A;&#x000A;                var properties;&#x000A;                if (style === 'height') {&#x000A;                  properties = ['border-top-width', 'padding-top',&#x000A;                   'padding-bottom', 'border-bottom-width'];&#x000A;                }&#x000A;                else {&#x000A;                  properties = ['border-left-width', 'padding-left',&#x000A;                   'padding-right', 'border-right-width'];&#x000A;                }&#x000A;                return properties.inject(dim, function(memo, property) {&#x000A;                  var val = proceed(element, property);&#x000A;                  return val === null ? memo : memo - parseInt(val, 10);&#x000A;                }) + 'px';&#x000A;              default: return proceed(element, style);&#x000A;            }&#x000A;          }&#x000A;        );&#x000A;&#x000A;        Element.Methods.readAttribute = Element.Methods.readAttribute.wrap(&#x000A;          function(proceed, element, attribute) {&#x000A;            if (attribute === 'title') return element.title;&#x000A;            return proceed(element, attribute);&#x000A;          }&#x000A;        );&#x000A;      }&#x000A;&#x000A;      else if (Prototype.Browser.IE) {&#x000A;        // IE doesn't report offsets correctly for static elements, so we change them&#x000A;        // to &quot;relative&quot; to get the values, then change them back.&#x000A;        Element.Methods.getOffsetParent = Element.Methods.getOffsetParent.wrap(&#x000A;          function(proceed, element) {&#x000A;            element = $(element);&#x000A;            // IE throws an error if element is not in document&#x000A;            try { element.offsetParent }&#x000A;            catch(e) { return $(document.body) }&#x000A;            var position = element.getStyle('position');&#x000A;            if (position !== 'static') return proceed(element);&#x000A;            element.setStyle({ position: 'relative' });&#x000A;            var value = proceed(element);&#x000A;            element.setStyle({ position: position });&#x000A;            return value;&#x000A;          }&#x000A;        );&#x000A;&#x000A;        $w('positionedOffset viewportOffset').each(function(method) {&#x000A;          Element.Methods[method] = Element.Methods[method].wrap(&#x000A;            function(proceed, element) {&#x000A;              element = $(element);&#x000A;              try { element.offsetParent }&#x000A;              catch(e) { return Element._returnOffset(0,0) }&#x000A;              var position = element.getStyle('position');&#x000A;              if (position !== 'static') return proceed(element);&#x000A;              // Trigger hasLayout on the offset parent so that IE6 reports&#x000A;              // accurate offsetTop and offsetLeft values for position: fixed.&#x000A;              var offsetParent = element.getOffsetParent();&#x000A;              if (offsetParent &amp;&amp; offsetParent.getStyle('position') === 'fixed')&#x000A;                offsetParent.setStyle({ zoom: 1 });&#x000A;              element.setStyle({ position: 'relative' });&#x000A;              var value = proceed(element);&#x000A;              element.setStyle({ position: position });&#x000A;              return value;&#x000A;            }&#x000A;          );&#x000A;        });&#x000A;&#x000A;        Element.Methods.cumulativeOffset = Element.Methods.cumulativeOffset.wrap(&#x000A;          function(proceed, element) {&#x000A;            try { element.offsetParent }&#x000A;            catch(e) { return Element._returnOffset(0,0) }&#x000A;            return proceed(element);&#x000A;          }&#x000A;        );&#x000A;&#x000A;        Element.Methods.getStyle = function(element, style) {&#x000A;          element = $(element);&#x000A;          style = (style == 'float' || style == 'cssFloat') ? 'styleFloat' : style.camelize();&#x000A;          var value = element.style[style];&#x000A;          if (!value &amp;&amp; element.currentStyle) value = element.currentStyle[style];&#x000A;&#x000A;          if (style == 'opacity') {&#x000A;            if (value = (element.getStyle('filter') || '').match(/alpha\(opacity=(.*)\)/))&#x000A;              if (value[1]) return parseFloat(value[1]) / 100;&#x000A;            return 1.0;&#x000A;          }&#x000A;&#x000A;          if (value == 'auto') {&#x000A;            if ((style == 'width' || style == 'height') &amp;&amp; (element.getStyle('display') != 'none'))&#x000A;              return element['offset' + style.capitalize()] + 'px';&#x000A;            return null;&#x000A;          }&#x000A;          return value;&#x000A;        };&#x000A;&#x000A;        Element.Methods.setOpacity = function(element, value) {&#x000A;          function stripAlpha(filter){&#x000A;            return filter.replace(/alpha\([^\)]*\)/gi,'');&#x000A;          }&#x000A;          element = $(element);&#x000A;          var currentStyle = element.currentStyle;&#x000A;          if ((currentStyle &amp;&amp; !currentStyle.hasLayout) ||&#x000A;            (!currentStyle &amp;&amp; element.style.zoom == 'normal'))&#x000A;              element.style.zoom = 1;&#x000A;&#x000A;          var filter = element.getStyle('filter'), style = element.style;&#x000A;          if (value == 1 || value === '') {&#x000A;            (filter = stripAlpha(filter)) ?&#x000A;              style.filter = filter : style.removeAttribute('filter');&#x000A;            return element;&#x000A;          } else if (value &lt; 0.00001) value = 0;&#x000A;          style.filter = stripAlpha(filter) +&#x000A;            'alpha(opacity=' + (value * 100) + ')';&#x000A;          return element;&#x000A;        };&#x000A;&#x000A;        Element._attributeTranslations = {&#x000A;          read: {&#x000A;            names: {&#x000A;              'class': 'className',&#x000A;              'for':   'htmlFor'&#x000A;            },&#x000A;            values: {&#x000A;              _getAttr: function(element, attribute) {&#x000A;                return element.getAttribute(attribute, 2);&#x000A;              },&#x000A;              _getAttrNode: function(element, attribute) {&#x000A;                var node = element.getAttributeNode(attribute);&#x000A;                return node ? node.value : &quot;&quot;;&#x000A;              },&#x000A;              _getEv: function(element, attribute) {&#x000A;                attribute = element.getAttribute(attribute);&#x000A;                return attribute ? attribute.toString().slice(23, -2) : null;&#x000A;              },&#x000A;              _flag: function(element, attribute) {&#x000A;                return $(element).hasAttribute(attribute) ? attribute : null;&#x000A;              },&#x000A;              style: function(element) {&#x000A;                return element.style.cssText.toLowerCase();&#x000A;              },&#x000A;              title: function(element) {&#x000A;                return element.title;&#x000A;              }&#x000A;            }&#x000A;          }&#x000A;        };&#x000A;&#x000A;        Element._attributeTranslations.write = {&#x000A;          names: Object.extend({&#x000A;            cellpadding: 'cellPadding',&#x000A;            cellspacing: 'cellSpacing'&#x000A;          }, Element._attributeTranslations.read.names),&#x000A;          values: {&#x000A;            checked: function(element, value) {&#x000A;              element.checked = !!value;&#x000A;            },&#x000A;&#x000A;            style: function(element, value) {&#x000A;              element.style.cssText = value ? value : '';&#x000A;            }&#x000A;          }&#x000A;        };&#x000A;&#x000A;        Element._attributeTranslations.has = {};&#x000A;&#x000A;        $w('colSpan rowSpan vAlign dateTime accessKey tabIndex ' +&#x000A;            'encType maxLength readOnly longDesc frameBorder').each(function(attr) {&#x000A;          Element._attributeTranslations.write.names[attr.toLowerCase()] = attr;&#x000A;          Element._attributeTranslations.has[attr.toLowerCase()] = attr;&#x000A;        });&#x000A;&#x000A;        (function(v) {&#x000A;          Object.extend(v, {&#x000A;            href:        v._getAttr,&#x000A;            src:         v._getAttr,&#x000A;            type:        v._getAttr,&#x000A;            action:      v._getAttrNode,&#x000A;            disabled:    v._flag,&#x000A;            checked:     v._flag,&#x000A;            readonly:    v._flag,&#x000A;            multiple:    v._flag,&#x000A;            onload:      v._getEv,&#x000A;            onunload:    v._getEv,&#x000A;            onclick:     v._getEv,&#x000A;            ondblclick:  v._getEv,&#x000A;            onmousedown: v._getEv,&#x000A;            onmouseup:   v._getEv,&#x000A;            onmouseover: v._getEv,&#x000A;            onmousemove: v._getEv,&#x000A;            onmouseout:  v._getEv,&#x000A;            onfocus:     v._getEv,&#x000A;            onblur:      v._getEv,&#x000A;            onkeypress:  v._getEv,&#x000A;            onkeydown:   v._getEv,&#x000A;            onkeyup:     v._getEv,&#x000A;            onsubmit:    v._getEv,&#x000A;            onreset:     v._getEv,&#x000A;            onselect:    v._getEv,&#x000A;            onchange:    v._getEv&#x000A;          });&#x000A;        })(Element._attributeTranslations.read.values);&#x000A;      }&#x000A;&#x000A;      else if (Prototype.Browser.Gecko &amp;&amp; /rv:1\.8\.0/.test(navigator.userAgent)) {&#x000A;        Element.Methods.setOpacity = function(element, value) {&#x000A;          element = $(element);&#x000A;          element.style.opacity = (value == 1) ? 0.999999 :&#x000A;            (value === '') ? '' : (value &lt; 0.00001) ? 0 : value;&#x000A;          return element;&#x000A;        };&#x000A;      }&#x000A;&#x000A;      else if (Prototype.Browser.WebKit) {&#x000A;        Element.Methods.setOpacity = function(element, value) {&#x000A;          element = $(element);&#x000A;          element.style.opacity = (value == 1 || value === '') ? '' :&#x000A;            (value &lt; 0.00001) ? 0 : value;&#x000A;&#x000A;          if (value == 1)&#x000A;            if(element.tagName.toUpperCase() == 'IMG' &amp;&amp; element.width) {&#x000A;              element.width++; element.width--;&#x000A;            } else try {&#x000A;              var n = document.createTextNode(' ');&#x000A;              element.appendChild(n);&#x000A;              element.removeChild(n);&#x000A;            } catch (e) { }&#x000A;&#x000A;          return element;&#x000A;        };&#x000A;&#x000A;        // Safari returns margins on body which is incorrect if the child is absolutely&#x000A;        // positioned.  For performance reasons, redefine Element#cumulativeOffset for&#x000A;        // KHTML/WebKit only.&#x000A;        Element.Methods.cumulativeOffset = function(element) {&#x000A;          var valueT = 0, valueL = 0;&#x000A;          do {&#x000A;            valueT += element.offsetTop  || 0;&#x000A;            valueL += element.offsetLeft || 0;&#x000A;            if (element.offsetParent == document.body)&#x000A;              if (Element.getStyle(element, 'position') == 'absolute') break;&#x000A;&#x000A;            element = element.offsetParent;&#x000A;          } while (element);&#x000A;&#x000A;          return Element._returnOffset(valueL, valueT);&#x000A;        };&#x000A;      }&#x000A;&#x000A;      if (Prototype.Browser.IE || Prototype.Browser.Opera) {&#x000A;        // IE and Opera are missing .innerHTML support for TABLE-related and SELECT elements&#x000A;        Element.Methods.update = function(element, content) {&#x000A;          element = $(element);&#x000A;&#x000A;          if (content &amp;&amp; content.toElement) content = content.toElement();&#x000A;          if (Object.isElement(content)) return element.update().insert(content);&#x000A;&#x000A;          content = Object.toHTML(content);&#x000A;          var tagName = element.tagName.toUpperCase();&#x000A;&#x000A;          if (tagName in Element._insertionTranslations.tags) {&#x000A;            $A(element.childNodes).each(function(node) { element.removeChild(node) });&#x000A;            Element._getContentFromAnonymousElement(tagName, content.stripScripts())&#x000A;              .each(function(node) { element.appendChild(node) });&#x000A;          }&#x000A;          else element.innerHTML = content.stripScripts();&#x000A;&#x000A;          content.evalScripts.bind(content).defer();&#x000A;          return element;&#x000A;        };&#x000A;      }&#x000A;&#x000A;      if ('outerHTML' in document.createElement('div')) {&#x000A;        Element.Methods.replace = function(element, content) {&#x000A;          element = $(element);&#x000A;&#x000A;          if (content &amp;&amp; content.toElement) content = content.toElement();&#x000A;          if (Object.isElement(content)) {&#x000A;            element.parentNode.replaceChild(content, element);&#x000A;            return element;&#x000A;          }&#x000A;&#x000A;          content = Object.toHTML(content);&#x000A;          var parent = element.parentNode, tagName = parent.tagName.toUpperCase();&#x000A;&#x000A;          if (Element._insertionTranslations.tags[tagName]) {&#x000A;            var nextSibling = element.next();&#x000A;            var fragments = Element._getContentFromAnonymousElement(tagName, content.stripScripts());&#x000A;            parent.removeChild(element);&#x000A;            if (nextSibling)&#x000A;              fragments.each(function(node) { parent.insertBefore(node, nextSibling) });&#x000A;            else&#x000A;              fragments.each(function(node) { parent.appendChild(node) });&#x000A;          }&#x000A;          else element.outerHTML = content.stripScripts();&#x000A;&#x000A;          content.evalScripts.bind(content).defer();&#x000A;          return element;&#x000A;        };&#x000A;      }&#x000A;&#x000A;      Element._returnOffset = function(l, t) {&#x000A;        var result = [l, t];&#x000A;        result.left = l;&#x000A;        result.top = t;&#x000A;        return result;&#x000A;      };&#x000A;&#x000A;      Element._getContentFromAnonymousElement = function(tagName, html) {&#x000A;        var div = new Element('div'), t = Element._insertionTranslations.tags[tagName];&#x000A;        if (t) {&#x000A;          div.innerHTML = t[0] + html + t[1];&#x000A;          t[2].times(function() { div = div.firstChild });&#x000A;        } else div.innerHTML = html;&#x000A;        return $A(div.childNodes);&#x000A;      };&#x000A;&#x000A;      Element._insertionTranslations = {&#x000A;        before: function(element, node) {&#x000A;          element.parentNode.insertBefore(node, element);&#x000A;        },&#x000A;        top: function(element, node) {&#x000A;          element.insertBefore(node, element.firstChild);&#x000A;        },&#x000A;        bottom: function(element, node) {&#x000A;          element.appendChild(node);&#x000A;        },&#x000A;        after: function(element, node) {&#x000A;          element.parentNode.insertBefore(node, element.nextSibling);&#x000A;        },&#x000A;        tags: {&#x000A;          TABLE:  ['&lt;table&gt;',                '&lt;/table&gt;',                   1],&#x000A;          TBODY:  ['&lt;table&gt;&lt;tbody&gt;',         '&lt;/tbody&gt;&lt;/table&gt;',           2],&#x000A;          TR:     ['&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;',     '&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;',      3],&#x000A;          TD:     ['&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;', '&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;', 4],&#x000A;          SELECT: ['&lt;select&gt;',               '&lt;/select&gt;',                  1]&#x000A;        }&#x000A;      };&#x000A;&#x000A;      (function() {&#x000A;        Object.extend(this.tags, {&#x000A;          THEAD: this.tags.TBODY,&#x000A;          TFOOT: this.tags.TBODY,&#x000A;          TH:    this.tags.TD&#x000A;        });&#x000A;      }).call(Element._insertionTranslations);&#x000A;&#x000A;      Element.Methods.Simulated = {&#x000A;        hasAttribute: function(element, attribute) {&#x000A;          attribute = Element._attributeTranslations.has[attribute] || attribute;&#x000A;          var node = $(element).getAttributeNode(attribute);&#x000A;          return !!(node &amp;&amp; node.specified);&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Element.Methods.ByTag = { };&#x000A;&#x000A;      Object.extend(Element, Element.Methods);&#x000A;&#x000A;      if (!Prototype.BrowserFeatures.ElementExtensions &amp;&amp;&#x000A;          document.createElement('div')['__proto__']) {&#x000A;        window.HTMLElement = { };&#x000A;        window.HTMLElement.prototype = document.createElement('div')['__proto__'];&#x000A;        Prototype.BrowserFeatures.ElementExtensions = true;&#x000A;      }&#x000A;&#x000A;      Element.extend = (function() {&#x000A;        if (Prototype.BrowserFeatures.SpecificElementExtensions)&#x000A;          return Prototype.K;&#x000A;&#x000A;        var Methods = { }, ByTag = Element.Methods.ByTag;&#x000A;&#x000A;        var extend = Object.extend(function(element) {&#x000A;          if (!element || element._extendedByPrototype ||&#x000A;              element.nodeType != 1 || element == window) return element;&#x000A;&#x000A;          var methods = Object.clone(Methods),&#x000A;            tagName = element.tagName.toUpperCase(), property, value;&#x000A;&#x000A;          // extend methods for specific tags&#x000A;          if (ByTag[tagName]) Object.extend(methods, ByTag[tagName]);&#x000A;&#x000A;          for (property in methods) {&#x000A;            value = methods[property];&#x000A;            if (Object.isFunction(value) &amp;&amp; !(property in element))&#x000A;              element[property] = value.methodize();&#x000A;          }&#x000A;&#x000A;          element._extendedByPrototype = Prototype.emptyFunction;&#x000A;          return element;&#x000A;&#x000A;        }, {&#x000A;          refresh: function() {&#x000A;            // extend methods for all tags (Safari doesn't need this)&#x000A;            if (!Prototype.BrowserFeatures.ElementExtensions) {&#x000A;              Object.extend(Methods, Element.Methods);&#x000A;              Object.extend(Methods, Element.Methods.Simulated);&#x000A;            }&#x000A;          }&#x000A;        });&#x000A;&#x000A;        extend.refresh();&#x000A;        return extend;&#x000A;      })();&#x000A;&#x000A;      Element.hasAttribute = function(element, attribute) {&#x000A;        if (element.hasAttribute) return element.hasAttribute(attribute);&#x000A;        return Element.Methods.Simulated.hasAttribute(element, attribute);&#x000A;      };&#x000A;&#x000A;      Element.addMethods = function(methods) {&#x000A;        var F = Prototype.BrowserFeatures, T = Element.Methods.ByTag;&#x000A;&#x000A;        if (!methods) {&#x000A;          Object.extend(Form, Form.Methods);&#x000A;          Object.extend(Form.Element, Form.Element.Methods);&#x000A;          Object.extend(Element.Methods.ByTag, {&#x000A;            &quot;FORM&quot;:     Object.clone(Form.Methods),&#x000A;            &quot;INPUT&quot;:    Object.clone(Form.Element.Methods),&#x000A;            &quot;SELECT&quot;:   Object.clone(Form.Element.Methods),&#x000A;            &quot;TEXTAREA&quot;: Object.clone(Form.Element.Methods)&#x000A;          });&#x000A;        }&#x000A;&#x000A;        if (arguments.length == 2) {&#x000A;          var tagName = methods;&#x000A;          methods = arguments[1];&#x000A;        }&#x000A;&#x000A;        if (!tagName) Object.extend(Element.Methods, methods || { });&#x000A;        else {&#x000A;          if (Object.isArray(tagName)) tagName.each(extend);&#x000A;          else extend(tagName);&#x000A;        }&#x000A;&#x000A;        function extend(tagName) {&#x000A;          tagName = tagName.toUpperCase();&#x000A;          if (!Element.Methods.ByTag[tagName])&#x000A;            Element.Methods.ByTag[tagName] = { };&#x000A;          Object.extend(Element.Methods.ByTag[tagName], methods);&#x000A;        }&#x000A;&#x000A;        function copy(methods, destination, onlyIfAbsent) {&#x000A;          onlyIfAbsent = onlyIfAbsent || false;&#x000A;          for (var property in methods) {&#x000A;            var value = methods[property];&#x000A;            if (!Object.isFunction(value)) continue;&#x000A;            if (!onlyIfAbsent || !(property in destination))&#x000A;              destination[property] = value.methodize();&#x000A;          }&#x000A;        }&#x000A;&#x000A;        function findDOMClass(tagName) {&#x000A;          var klass;&#x000A;          var trans = {&#x000A;            &quot;OPTGROUP&quot;: &quot;OptGroup&quot;, &quot;TEXTAREA&quot;: &quot;TextArea&quot;, &quot;P&quot;: &quot;Paragraph&quot;,&#x000A;            &quot;FIELDSET&quot;: &quot;FieldSet&quot;, &quot;UL&quot;: &quot;UList&quot;, &quot;OL&quot;: &quot;OList&quot;, &quot;DL&quot;: &quot;DList&quot;,&#x000A;            &quot;DIR&quot;: &quot;Directory&quot;, &quot;H1&quot;: &quot;Heading&quot;, &quot;H2&quot;: &quot;Heading&quot;, &quot;H3&quot;: &quot;Heading&quot;,&#x000A;            &quot;H4&quot;: &quot;Heading&quot;, &quot;H5&quot;: &quot;Heading&quot;, &quot;H6&quot;: &quot;Heading&quot;, &quot;Q&quot;: &quot;Quote&quot;,&#x000A;            &quot;INS&quot;: &quot;Mod&quot;, &quot;DEL&quot;: &quot;Mod&quot;, &quot;A&quot;: &quot;Anchor&quot;, &quot;IMG&quot;: &quot;Image&quot;, &quot;CAPTION&quot;:&#x000A;            &quot;TableCaption&quot;, &quot;COL&quot;: &quot;TableCol&quot;, &quot;COLGROUP&quot;: &quot;TableCol&quot;, &quot;THEAD&quot;:&#x000A;            &quot;TableSection&quot;, &quot;TFOOT&quot;: &quot;TableSection&quot;, &quot;TBODY&quot;: &quot;TableSection&quot;, &quot;TR&quot;:&#x000A;            &quot;TableRow&quot;, &quot;TH&quot;: &quot;TableCell&quot;, &quot;TD&quot;: &quot;TableCell&quot;, &quot;FRAMESET&quot;:&#x000A;            &quot;FrameSet&quot;, &quot;IFRAME&quot;: &quot;IFrame&quot;&#x000A;          };&#x000A;          if (trans[tagName]) klass = 'HTML' + trans[tagName] + 'Element';&#x000A;          if (window[klass]) return window[klass];&#x000A;          klass = 'HTML' + tagName + 'Element';&#x000A;          if (window[klass]) return window[klass];&#x000A;          klass = 'HTML' + tagName.capitalize() + 'Element';&#x000A;          if (window[klass]) return window[klass];&#x000A;&#x000A;          window[klass] = { };&#x000A;          window[klass].prototype = document.createElement(tagName)['__proto__'];&#x000A;          return window[klass];&#x000A;        }&#x000A;&#x000A;        if (F.ElementExtensions) {&#x000A;          copy(Element.Methods, HTMLElement.prototype);&#x000A;          copy(Element.Methods.Simulated, HTMLElement.prototype, true);&#x000A;        }&#x000A;&#x000A;        if (F.SpecificElementExtensions) {&#x000A;          for (var tag in Element.Methods.ByTag) {&#x000A;            var klass = findDOMClass(tag);&#x000A;            if (Object.isUndefined(klass)) continue;&#x000A;            copy(T[tag], klass.prototype);&#x000A;          }&#x000A;        }&#x000A;&#x000A;        Object.extend(Element, Element.Methods);&#x000A;        delete Element.ByTag;&#x000A;&#x000A;        if (Element.extend.refresh) Element.extend.refresh();&#x000A;        Element.cache = { };&#x000A;      };&#x000A;&#x000A;      document.viewport = {&#x000A;        getDimensions: function() {&#x000A;          var dimensions = { }, B = Prototype.Browser;&#x000A;          $w('width height').each(function(d) {&#x000A;            var D = d.capitalize();&#x000A;            if (B.WebKit &amp;&amp; !document.evaluate) {&#x000A;              // Safari &lt;3.0 needs self.innerWidth/Height&#x000A;              dimensions[d] = self['inner' + D];&#x000A;            } else if (B.Opera &amp;&amp; parseFloat(window.opera.version()) &lt; 9.5) {&#x000A;              // Opera &lt;9.5 needs document.body.clientWidth/Height&#x000A;              dimensions[d] = document.body['client' + D]&#x000A;            } else {&#x000A;              dimensions[d] = document.documentElement['client' + D];&#x000A;            }&#x000A;          });&#x000A;          return dimensions;&#x000A;        },&#x000A;&#x000A;        getWidth: function() {&#x000A;          return this.getDimensions().width;&#x000A;        },&#x000A;&#x000A;        getHeight: function() {&#x000A;          return this.getDimensions().height;&#x000A;        },&#x000A;&#x000A;        getScrollOffsets: function() {&#x000A;          return Element._returnOffset(&#x000A;            window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft,&#x000A;            window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop);&#x000A;        }&#x000A;      };&#x000A;      /* Portions of the Selector class are derived from Jack Slocum's DomQuery,&#x000A;       * part of YUI-Ext version 0.40, distributed under the terms of an MIT-style&#x000A;       * license.  Please see http://www.yui-ext.com/ for more information. */&#x000A;&#x000A;      var Selector = Class.create({&#x000A;        initialize: function(expression) {&#x000A;          this.expression = expression.strip();&#x000A;&#x000A;          if (this.shouldUseSelectorsAPI()) {&#x000A;            this.mode = 'selectorsAPI';&#x000A;          } else if (this.shouldUseXPath()) {&#x000A;            this.mode = 'xpath';&#x000A;            this.compileXPathMatcher();&#x000A;          } else {&#x000A;            this.mode = &quot;normal&quot;;&#x000A;            this.compileMatcher();&#x000A;          }&#x000A;&#x000A;        },&#x000A;&#x000A;        shouldUseXPath: function() {&#x000A;          if (!Prototype.BrowserFeatures.XPath) return false;&#x000A;&#x000A;          var e = this.expression;&#x000A;&#x000A;          // Safari 3 chokes on :*-of-type and :empty&#x000A;          if (Prototype.Browser.WebKit &amp;&amp;&#x000A;           (e.include(&quot;-of-type&quot;) || e.include(&quot;:empty&quot;)))&#x000A;            return false;&#x000A;&#x000A;          // XPath can't do namespaced attributes, nor can it read&#x000A;          // the &quot;checked&quot; property from DOM nodes&#x000A;          if ((/(\[[\w-]*?:|:checked)/).test(e))&#x000A;            return false;&#x000A;&#x000A;          return true;&#x000A;        },&#x000A;&#x000A;        shouldUseSelectorsAPI: function() {&#x000A;          if (!Prototype.BrowserFeatures.SelectorsAPI) return false;&#x000A;&#x000A;          if (!Selector._div) Selector._div = new Element('div');&#x000A;&#x000A;          // Make sure the browser treats the selector as valid. Test on an&#x000A;          // isolated element to minimize cost of this check.&#x000A;          try {&#x000A;            Selector._div.querySelector(this.expression);&#x000A;          } catch(e) {&#x000A;            return false;&#x000A;          }&#x000A;&#x000A;          return true;&#x000A;        },&#x000A;&#x000A;        compileMatcher: function() {&#x000A;          var e = this.expression, ps = Selector.patterns, h = Selector.handlers,&#x000A;              c = Selector.criteria, le, p, m;&#x000A;&#x000A;          if (Selector._cache[e]) {&#x000A;            this.matcher = Selector._cache[e];&#x000A;            return;&#x000A;          }&#x000A;&#x000A;          this.matcher = [&quot;this.matcher = function(root) {&quot;,&#x000A;                          &quot;var r = root, h = Selector.handlers, c = false, n;&quot;];&#x000A;&#x000A;          while (e &amp;&amp; le != e &amp;&amp; (/\S/).test(e)) {&#x000A;            le = e;&#x000A;            for (var i in ps) {&#x000A;              p = ps[i];&#x000A;              if (m = e.match(p)) {&#x000A;                this.matcher.push(Object.isFunction(c[i]) ? c[i](m) :&#x000A;                  new Template(c[i]).evaluate(m));&#x000A;                e = e.replace(m[0], '');&#x000A;                break;&#x000A;              }&#x000A;            }&#x000A;          }&#x000A;&#x000A;          this.matcher.push(&quot;return h.unique(n);\n}&quot;);&#x000A;          eval(this.matcher.join('\n'));&#x000A;          Selector._cache[this.expression] = this.matcher;&#x000A;        },&#x000A;&#x000A;        compileXPathMatcher: function() {&#x000A;          var e = this.expression, ps = Selector.patterns,&#x000A;              x = Selector.xpath, le, m;&#x000A;&#x000A;          if (Selector._cache[e]) {&#x000A;            this.xpath = Selector._cache[e]; return;&#x000A;          }&#x000A;&#x000A;          this.matcher = ['.//*'];&#x000A;          while (e &amp;&amp; le != e &amp;&amp; (/\S/).test(e)) {&#x000A;            le = e;&#x000A;            for (var i in ps) {&#x000A;              if (m = e.match(ps[i])) {&#x000A;                this.matcher.push(Object.isFunction(x[i]) ? x[i](m) :&#x000A;                  new Template(x[i]).evaluate(m));&#x000A;                e = e.replace(m[0], '');&#x000A;                break;&#x000A;              }&#x000A;            }&#x000A;          }&#x000A;&#x000A;          this.xpath = this.matcher.join('');&#x000A;          Selector._cache[this.expression] = this.xpath;&#x000A;        },&#x000A;&#x000A;        findElements: function(root) {&#x000A;          root = root || document;&#x000A;          var e = this.expression, results;&#x000A;&#x000A;          switch (this.mode) {&#x000A;            case 'selectorsAPI':&#x000A;              // querySelectorAll queries document-wide, then filters to descendants&#x000A;              // of the context element. That's not what we want.&#x000A;              // Add an explicit context to the selector if necessary.&#x000A;              if (root !== document) {&#x000A;                var oldId = root.id, id = $(root).identify();&#x000A;                e = &quot;#&quot; + id + &quot; &quot; + e;&#x000A;              }&#x000A;&#x000A;              results = $A(root.querySelectorAll(e)).map(Element.extend);&#x000A;              root.id = oldId;&#x000A;&#x000A;              return results;&#x000A;            case 'xpath':&#x000A;              return document._getElementsByXPath(this.xpath, root);&#x000A;            default:&#x000A;             return this.matcher(root);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        match: function(element) {&#x000A;          this.tokens = [];&#x000A;&#x000A;          var e = this.expression, ps = Selector.patterns, as = Selector.assertions;&#x000A;          var le, p, m;&#x000A;&#x000A;          while (e &amp;&amp; le !== e &amp;&amp; (/\S/).test(e)) {&#x000A;            le = e;&#x000A;            for (var i in ps) {&#x000A;              p = ps[i];&#x000A;              if (m = e.match(p)) {&#x000A;                // use the Selector.assertions methods unless the selector&#x000A;                // is too complex.&#x000A;                if (as[i]) {&#x000A;                  this.tokens.push([i, Object.clone(m)]);&#x000A;                  e = e.replace(m[0], '');&#x000A;                } else {&#x000A;                  // reluctantly do a document-wide search&#x000A;                  // and look for a match in the array&#x000A;                  return this.findElements(document).include(element);&#x000A;                }&#x000A;              }&#x000A;            }&#x000A;          }&#x000A;&#x000A;          var match = true, name, matches;&#x000A;          for (var i = 0, token; token = this.tokens[i]; i++) {&#x000A;            name = token[0], matches = token[1];&#x000A;            if (!Selector.assertions[name](element, matches)) {&#x000A;              match = false; break;&#x000A;            }&#x000A;          }&#x000A;&#x000A;          return match;&#x000A;        },&#x000A;&#x000A;        toString: function() {&#x000A;          return this.expression;&#x000A;        },&#x000A;&#x000A;        inspect: function() {&#x000A;          return &quot;#&lt;Selector:&quot; + this.expression.inspect() + &quot;&gt;&quot;;&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Object.extend(Selector, {&#x000A;        _cache: { },&#x000A;&#x000A;        xpath: {&#x000A;          descendant:   &quot;//*&quot;,&#x000A;          child:        &quot;/*&quot;,&#x000A;          adjacent:     &quot;/following-sibling::*[1]&quot;,&#x000A;          laterSibling: '/following-sibling::*',&#x000A;          tagName:      function(m) {&#x000A;            if (m[1] == '*') return '';&#x000A;            return &quot;[local-name()='&quot; + m[1].toLowerCase() +&#x000A;                   &quot;' or local-name()='&quot; + m[1].toUpperCase() + &quot;']&quot;;&#x000A;          },&#x000A;          className:    &quot;[contains(concat(' ', @class, ' '), ' #{1} ')]&quot;,&#x000A;          id:           &quot;[@id='#{1}']&quot;,&#x000A;          attrPresence: function(m) {&#x000A;            m[1] = m[1].toLowerCase();&#x000A;            return new Template(&quot;[@#{1}]&quot;).evaluate(m);&#x000A;          },&#x000A;          attr: function(m) {&#x000A;            m[1] = m[1].toLowerCase();&#x000A;            m[3] = m[5] || m[6];&#x000A;            return new Template(Selector.xpath.operators[m[2]]).evaluate(m);&#x000A;          },&#x000A;          pseudo: function(m) {&#x000A;            var h = Selector.xpath.pseudos[m[1]];&#x000A;            if (!h) return '';&#x000A;            if (Object.isFunction(h)) return h(m);&#x000A;            return new Template(Selector.xpath.pseudos[m[1]]).evaluate(m);&#x000A;          },&#x000A;          operators: {&#x000A;            '=':  &quot;[@#{1}='#{3}']&quot;,&#x000A;            '!=': &quot;[@#{1}!='#{3}']&quot;,&#x000A;            '^=': &quot;[starts-with(@#{1}, '#{3}')]&quot;,&#x000A;            '$=': &quot;[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']&quot;,&#x000A;            '*=': &quot;[contains(@#{1}, '#{3}')]&quot;,&#x000A;            '~=': &quot;[contains(concat(' ', @#{1}, ' '), ' #{3} ')]&quot;,&#x000A;            '|=': &quot;[contains(concat('-', @#{1}, '-'), '-#{3}-')]&quot;&#x000A;          },&#x000A;          pseudos: {&#x000A;            'first-child': '[not(preceding-sibling::*)]',&#x000A;            'last-child':  '[not(following-sibling::*)]',&#x000A;            'only-child':  '[not(preceding-sibling::* or following-sibling::*)]',&#x000A;            'empty':       &quot;[count(*) = 0 and (count(text()) = 0)]&quot;,&#x000A;            'checked':     &quot;[@checked]&quot;,&#x000A;            'disabled':    &quot;[(@disabled) and (@type!='hidden')]&quot;,&#x000A;            'enabled':     &quot;[not(@disabled) and (@type!='hidden')]&quot;,&#x000A;            'not': function(m) {&#x000A;              var e = m[6], p = Selector.patterns,&#x000A;                  x = Selector.xpath, le, v;&#x000A;&#x000A;              var exclusion = [];&#x000A;              while (e &amp;&amp; le != e &amp;&amp; (/\S/).test(e)) {&#x000A;                le = e;&#x000A;                for (var i in p) {&#x000A;                  if (m = e.match(p[i])) {&#x000A;                    v = Object.isFunction(x[i]) ? x[i](m) : new Template(x[i]).evaluate(m);&#x000A;                    exclusion.push(&quot;(&quot; + v.substring(1, v.length - 1) + &quot;)&quot;);&#x000A;                    e = e.replace(m[0], '');&#x000A;                    break;&#x000A;                  }&#x000A;                }&#x000A;              }&#x000A;              return &quot;[not(&quot; + exclusion.join(&quot; and &quot;) + &quot;)]&quot;;&#x000A;            },&#x000A;            'nth-child':      function(m) {&#x000A;              return Selector.xpath.pseudos.nth(&quot;(count(./preceding-sibling::*) + 1) &quot;, m);&#x000A;            },&#x000A;            'nth-last-child': function(m) {&#x000A;              return Selector.xpath.pseudos.nth(&quot;(count(./following-sibling::*) + 1) &quot;, m);&#x000A;            },&#x000A;            'nth-of-type':    function(m) {&#x000A;              return Selector.xpath.pseudos.nth(&quot;position() &quot;, m);&#x000A;            },&#x000A;            'nth-last-of-type': function(m) {&#x000A;              return Selector.xpath.pseudos.nth(&quot;(last() + 1 - position()) &quot;, m);&#x000A;            },&#x000A;            'first-of-type':  function(m) {&#x000A;              m[6] = &quot;1&quot;; return Selector.xpath.pseudos['nth-of-type'](m);&#x000A;            },&#x000A;            'last-of-type':   function(m) {&#x000A;              m[6] = &quot;1&quot;; return Selector.xpath.pseudos['nth-last-of-type'](m);&#x000A;            },&#x000A;            'only-of-type':   function(m) {&#x000A;              var p = Selector.xpath.pseudos; return p['first-of-type'](m) + p['last-of-type'](m);&#x000A;            },&#x000A;            nth: function(fragment, m) {&#x000A;              var mm, formula = m[6], predicate;&#x000A;              if (formula == 'even') formula = '2n+0';&#x000A;              if (formula == 'odd')  formula = '2n+1';&#x000A;              if (mm = formula.match(/^(\d+)$/)) // digit only&#x000A;                return '[' + fragment + &quot;= &quot; + mm[1] + ']';&#x000A;              if (mm = formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // an+b&#x000A;                if (mm[1] == &quot;-&quot;) mm[1] = -1;&#x000A;                var a = mm[1] ? Number(mm[1]) : 1;&#x000A;                var b = mm[2] ? Number(mm[2]) : 0;&#x000A;                predicate = &quot;[((#{fragment} - #{b}) mod #{a} = 0) and &quot; +&#x000A;                &quot;((#{fragment} - #{b}) div #{a} &gt;= 0)]&quot;;&#x000A;                return new Template(predicate).evaluate({&#x000A;                  fragment: fragment, a: a, b: b });&#x000A;              }&#x000A;            }&#x000A;          }&#x000A;        },&#x000A;&#x000A;        criteria: {&#x000A;          tagName:      'n = h.tagName(n, r, &quot;#{1}&quot;, c);      c = false;',&#x000A;          className:    'n = h.className(n, r, &quot;#{1}&quot;, c);    c = false;',&#x000A;          id:           'n = h.id(n, r, &quot;#{1}&quot;, c);           c = false;',&#x000A;          attrPresence: 'n = h.attrPresence(n, r, &quot;#{1}&quot;, c); c = false;',&#x000A;          attr: function(m) {&#x000A;            m[3] = (m[5] || m[6]);&#x000A;            return new Template('n = h.attr(n, r, &quot;#{1}&quot;, &quot;#{3}&quot;, &quot;#{2}&quot;, c); c = false;').evaluate(m);&#x000A;          },&#x000A;          pseudo: function(m) {&#x000A;            if (m[6]) m[6] = m[6].replace(/&quot;/g, '\\&quot;');&#x000A;            return new Template('n = h.pseudo(n, &quot;#{1}&quot;, &quot;#{6}&quot;, r, c); c = false;').evaluate(m);&#x000A;          },&#x000A;          descendant:   'c = &quot;descendant&quot;;',&#x000A;          child:        'c = &quot;child&quot;;',&#x000A;          adjacent:     'c = &quot;adjacent&quot;;',&#x000A;          laterSibling: 'c = &quot;laterSibling&quot;;'&#x000A;        },&#x000A;&#x000A;        patterns: {&#x000A;          // combinators must be listed first&#x000A;          // (and descendant needs to be last combinator)&#x000A;          laterSibling: /^\s*~\s*/,&#x000A;          child:        /^\s*&gt;\s*/,&#x000A;          adjacent:     /^\s*\+\s*/,&#x000A;          descendant:   /^\s/,&#x000A;&#x000A;          // selectors follow&#x000A;          tagName:      /^\s*(\*|[\w\-]+)(\b|$)?/,&#x000A;          id:           /^#([\w\-\*]+)(\b|$)/,&#x000A;          className:    /^\.([\w\-\*]+)(\b|$)/,&#x000A;          pseudo:&#x000A;      /^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~&gt;]))/,&#x000A;          attrPresence: /^\[((?:[\w]+:)?[\w]+)\]/,&#x000A;          attr:         /\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['&quot;])([^\4]*?)\4|([^'&quot;][^\]]*?)))?\]/&#x000A;        },&#x000A;&#x000A;        // for Selector.match and Element#match&#x000A;        assertions: {&#x000A;          tagName: function(element, matches) {&#x000A;            return matches[1].toUpperCase() == element.tagName.toUpperCase();&#x000A;          },&#x000A;&#x000A;          className: function(element, matches) {&#x000A;            return Element.hasClassName(element, matches[1]);&#x000A;          },&#x000A;&#x000A;          id: function(element, matches) {&#x000A;            return element.id === matches[1];&#x000A;          },&#x000A;&#x000A;          attrPresence: function(element, matches) {&#x000A;            return Element.hasAttribute(element, matches[1]);&#x000A;          },&#x000A;&#x000A;          attr: function(element, matches) {&#x000A;            var nodeValue = Element.readAttribute(element, matches[1]);&#x000A;            return nodeValue &amp;&amp; Selector.operators[matches[2]](nodeValue, matches[5] || matches[6]);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        handlers: {&#x000A;          // UTILITY FUNCTIONS&#x000A;          // joins two collections&#x000A;          concat: function(a, b) {&#x000A;            for (var i = 0, node; node = b[i]; i++)&#x000A;              a.push(node);&#x000A;            return a;&#x000A;          },&#x000A;&#x000A;          // marks an array of nodes for counting&#x000A;          mark: function(nodes) {&#x000A;            var _true = Prototype.emptyFunction;&#x000A;            for (var i = 0, node; node = nodes[i]; i++)&#x000A;              node._countedByPrototype = _true;&#x000A;            return nodes;&#x000A;          },&#x000A;&#x000A;          unmark: function(nodes) {&#x000A;            for (var i = 0, node; node = nodes[i]; i++)&#x000A;              node._countedByPrototype = undefined;&#x000A;            return nodes;&#x000A;          },&#x000A;&#x000A;          // mark each child node with its position (for nth calls)&#x000A;          // &quot;ofType&quot; flag indicates whether we're indexing for nth-of-type&#x000A;          // rather than nth-child&#x000A;          index: function(parentNode, reverse, ofType) {&#x000A;            parentNode._countedByPrototype = Prototype.emptyFunction;&#x000A;            if (reverse) {&#x000A;              for (var nodes = parentNode.childNodes, i = nodes.length - 1, j = 1; i &gt;= 0; i--) {&#x000A;                var node = nodes[i];&#x000A;                if (node.nodeType == 1 &amp;&amp; (!ofType || node._countedByPrototype)) node.nodeIndex = j++;&#x000A;              }&#x000A;            } else {&#x000A;              for (var i = 0, j = 1, nodes = parentNode.childNodes; node = nodes[i]; i++)&#x000A;                if (node.nodeType == 1 &amp;&amp; (!ofType || node._countedByPrototype)) node.nodeIndex = j++;&#x000A;            }&#x000A;          },&#x000A;&#x000A;          // filters out duplicates and extends all nodes&#x000A;          unique: function(nodes) {&#x000A;            if (nodes.length == 0) return nodes;&#x000A;            var results = [], n;&#x000A;            for (var i = 0, l = nodes.length; i &lt; l; i++)&#x000A;              if (!(n = nodes[i])._countedByPrototype) {&#x000A;                n._countedByPrototype = Prototype.emptyFunction;&#x000A;                results.push(Element.extend(n));&#x000A;              }&#x000A;            return Selector.handlers.unmark(results);&#x000A;          },&#x000A;&#x000A;          // COMBINATOR FUNCTIONS&#x000A;          descendant: function(nodes) {&#x000A;            var h = Selector.handlers;&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              h.concat(results, node.getElementsByTagName('*'));&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          child: function(nodes) {&#x000A;            var h = Selector.handlers;&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++) {&#x000A;              for (var j = 0, child; child = node.childNodes[j]; j++)&#x000A;                if (child.nodeType == 1 &amp;&amp; child.tagName != '!') results.push(child);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          adjacent: function(nodes) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++) {&#x000A;              var next = this.nextElementSibling(node);&#x000A;              if (next) results.push(next);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          laterSibling: function(nodes) {&#x000A;            var h = Selector.handlers;&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              h.concat(results, Element.nextSiblings(node));&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          nextElementSibling: function(node) {&#x000A;            while (node = node.nextSibling)&#x000A;              if (node.nodeType == 1) return node;&#x000A;            return null;&#x000A;          },&#x000A;&#x000A;          previousElementSibling: function(node) {&#x000A;            while (node = node.previousSibling)&#x000A;              if (node.nodeType == 1) return node;&#x000A;            return null;&#x000A;          },&#x000A;&#x000A;          // TOKEN FUNCTIONS&#x000A;          tagName: function(nodes, root, tagName, combinator) {&#x000A;            var uTagName = tagName.toUpperCase();&#x000A;            var results = [], h = Selector.handlers;&#x000A;            if (nodes) {&#x000A;              if (combinator) {&#x000A;                // fastlane for ordinary descendant combinators&#x000A;                if (combinator == &quot;descendant&quot;) {&#x000A;                  for (var i = 0, node; node = nodes[i]; i++)&#x000A;                    h.concat(results, node.getElementsByTagName(tagName));&#x000A;                  return results;&#x000A;                } else nodes = this[combinator](nodes);&#x000A;                if (tagName == &quot;*&quot;) return nodes;&#x000A;              }&#x000A;              for (var i = 0, node; node = nodes[i]; i++)&#x000A;                if (node.tagName.toUpperCase() === uTagName) results.push(node);&#x000A;              return results;&#x000A;            } else return root.getElementsByTagName(tagName);&#x000A;          },&#x000A;&#x000A;          id: function(nodes, root, id, combinator) {&#x000A;            var targetNode = $(id), h = Selector.handlers;&#x000A;            if (!targetNode) return [];&#x000A;            if (!nodes &amp;&amp; root == document) return [targetNode];&#x000A;            if (nodes) {&#x000A;              if (combinator) {&#x000A;                if (combinator == 'child') {&#x000A;                  for (var i = 0, node; node = nodes[i]; i++)&#x000A;                    if (targetNode.parentNode == node) return [targetNode];&#x000A;                } else if (combinator == 'descendant') {&#x000A;                  for (var i = 0, node; node = nodes[i]; i++)&#x000A;                    if (Element.descendantOf(targetNode, node)) return [targetNode];&#x000A;                } else if (combinator == 'adjacent') {&#x000A;                  for (var i = 0, node; node = nodes[i]; i++)&#x000A;                    if (Selector.handlers.previousElementSibling(targetNode) == node)&#x000A;                      return [targetNode];&#x000A;                } else nodes = h[combinator](nodes);&#x000A;              }&#x000A;              for (var i = 0, node; node = nodes[i]; i++)&#x000A;                if (node == targetNode) return [targetNode];&#x000A;              return [];&#x000A;            }&#x000A;            return (targetNode &amp;&amp; Element.descendantOf(targetNode, root)) ? [targetNode] : [];&#x000A;          },&#x000A;&#x000A;          className: function(nodes, root, className, combinator) {&#x000A;            if (nodes &amp;&amp; combinator) nodes = this[combinator](nodes);&#x000A;            return Selector.handlers.byClassName(nodes, root, className);&#x000A;          },&#x000A;&#x000A;          byClassName: function(nodes, root, className) {&#x000A;            if (!nodes) nodes = Selector.handlers.descendant([root]);&#x000A;            var needle = ' ' + className + ' ';&#x000A;            for (var i = 0, results = [], node, nodeClassName; node = nodes[i]; i++) {&#x000A;              nodeClassName = node.className;&#x000A;              if (nodeClassName.length == 0) continue;&#x000A;              if (nodeClassName == className || (' ' + nodeClassName + ' ').include(needle))&#x000A;                results.push(node);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          attrPresence: function(nodes, root, attr, combinator) {&#x000A;            if (!nodes) nodes = root.getElementsByTagName(&quot;*&quot;);&#x000A;            if (nodes &amp;&amp; combinator) nodes = this[combinator](nodes);&#x000A;            var results = [];&#x000A;            for (var i = 0, node; node = nodes[i]; i++)&#x000A;              if (Element.hasAttribute(node, attr)) results.push(node);&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          attr: function(nodes, root, attr, value, operator, combinator) {&#x000A;            if (!nodes) nodes = root.getElementsByTagName(&quot;*&quot;);&#x000A;            if (nodes &amp;&amp; combinator) nodes = this[combinator](nodes);&#x000A;            var handler = Selector.operators[operator], results = [];&#x000A;            for (var i = 0, node; node = nodes[i]; i++) {&#x000A;              var nodeValue = Element.readAttribute(node, attr);&#x000A;              if (nodeValue === null) continue;&#x000A;              if (handler(nodeValue, value)) results.push(node);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          pseudo: function(nodes, name, value, root, combinator) {&#x000A;            if (nodes &amp;&amp; combinator) nodes = this[combinator](nodes);&#x000A;            if (!nodes) nodes = root.getElementsByTagName(&quot;*&quot;);&#x000A;            return Selector.pseudos[name](nodes, value, root);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        pseudos: {&#x000A;          'first-child': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++) {&#x000A;              if (Selector.handlers.previousElementSibling(node)) continue;&#x000A;                results.push(node);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;          'last-child': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++) {&#x000A;              if (Selector.handlers.nextElementSibling(node)) continue;&#x000A;                results.push(node);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;          'only-child': function(nodes, value, root) {&#x000A;            var h = Selector.handlers;&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              if (!h.previousElementSibling(node) &amp;&amp; !h.nextElementSibling(node))&#x000A;                results.push(node);&#x000A;            return results;&#x000A;          },&#x000A;          'nth-child':        function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, formula, root);&#x000A;          },&#x000A;          'nth-last-child':   function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, formula, root, true);&#x000A;          },&#x000A;          'nth-of-type':      function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, formula, root, false, true);&#x000A;          },&#x000A;          'nth-last-of-type': function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, formula, root, true, true);&#x000A;          },&#x000A;          'first-of-type':    function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, &quot;1&quot;, root, false, true);&#x000A;          },&#x000A;          'last-of-type':     function(nodes, formula, root) {&#x000A;            return Selector.pseudos.nth(nodes, &quot;1&quot;, root, true, true);&#x000A;          },&#x000A;          'only-of-type':     function(nodes, formula, root) {&#x000A;            var p = Selector.pseudos;&#x000A;            return p['last-of-type'](p['first-of-type'](nodes, formula, root), formula, root);&#x000A;          },&#x000A;&#x000A;          // handles the an+b logic&#x000A;          getIndices: function(a, b, total) {&#x000A;            if (a == 0) return b &gt; 0 ? [b] : [];&#x000A;            return $R(1, total).inject([], function(memo, i) {&#x000A;              if (0 == (i - b) % a &amp;&amp; (i - b) / a &gt;= 0) memo.push(i);&#x000A;              return memo;&#x000A;            });&#x000A;          },&#x000A;&#x000A;          // handles nth(-last)-child, nth(-last)-of-type, and (first|last)-of-type&#x000A;          nth: function(nodes, formula, root, reverse, ofType) {&#x000A;            if (nodes.length == 0) return [];&#x000A;            if (formula == 'even') formula = '2n+0';&#x000A;            if (formula == 'odd')  formula = '2n+1';&#x000A;            var h = Selector.handlers, results = [], indexed = [], m;&#x000A;            h.mark(nodes);&#x000A;            for (var i = 0, node; node = nodes[i]; i++) {&#x000A;              if (!node.parentNode._countedByPrototype) {&#x000A;                h.index(node.parentNode, reverse, ofType);&#x000A;                indexed.push(node.parentNode);&#x000A;              }&#x000A;            }&#x000A;            if (formula.match(/^\d+$/)) { // just a number&#x000A;              formula = Number(formula);&#x000A;              for (var i = 0, node; node = nodes[i]; i++)&#x000A;                if (node.nodeIndex == formula) results.push(node);&#x000A;            } else if (m = formula.match(/^(-?\d*)?n(([+-])(\d+))?/)) { // an+b&#x000A;              if (m[1] == &quot;-&quot;) m[1] = -1;&#x000A;              var a = m[1] ? Number(m[1]) : 1;&#x000A;              var b = m[2] ? Number(m[2]) : 0;&#x000A;              var indices = Selector.pseudos.getIndices(a, b, nodes.length);&#x000A;              for (var i = 0, node, l = indices.length; node = nodes[i]; i++) {&#x000A;                for (var j = 0; j &lt; l; j++)&#x000A;                  if (node.nodeIndex == indices[j]) results.push(node);&#x000A;              }&#x000A;            }&#x000A;            h.unmark(nodes);&#x000A;            h.unmark(indexed);&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          'empty': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++) {&#x000A;              // IE treats comments as element nodes&#x000A;              if (node.tagName == '!' || node.firstChild) continue;&#x000A;              results.push(node);&#x000A;            }&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          'not': function(nodes, selector, root) {&#x000A;            var h = Selector.handlers, selectorType, m;&#x000A;            var exclusions = new Selector(selector).findElements(root);&#x000A;            h.mark(exclusions);&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              if (!node._countedByPrototype) results.push(node);&#x000A;            h.unmark(exclusions);&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          'enabled': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              if (!node.disabled &amp;&amp; (!node.type || node.type !== 'hidden'))&#x000A;                results.push(node);&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          'disabled': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              if (node.disabled) results.push(node);&#x000A;            return results;&#x000A;          },&#x000A;&#x000A;          'checked': function(nodes, value, root) {&#x000A;            for (var i = 0, results = [], node; node = nodes[i]; i++)&#x000A;              if (node.checked) results.push(node);&#x000A;            return results;&#x000A;          }&#x000A;        },&#x000A;&#x000A;        operators: {&#x000A;          '=':  function(nv, v) { return nv == v; },&#x000A;          '!=': function(nv, v) { return nv != v; },&#x000A;          '^=': function(nv, v) { return nv == v || nv &amp;&amp; nv.startsWith(v); },&#x000A;          '$=': function(nv, v) { return nv == v || nv &amp;&amp; nv.endsWith(v); },&#x000A;          '*=': function(nv, v) { return nv == v || nv &amp;&amp; nv.include(v); },&#x000A;          '$=': function(nv, v) { return nv.endsWith(v); },&#x000A;          '*=': function(nv, v) { return nv.include(v); },&#x000A;          '~=': function(nv, v) { return (' ' + nv + ' ').include(' ' + v + ' '); },&#x000A;          '|=': function(nv, v) { return ('-' + (nv || &quot;&quot;).toUpperCase() +&#x000A;           '-').include('-' + (v || &quot;&quot;).toUpperCase() + '-'); }&#x000A;        },&#x000A;&#x000A;        split: function(expression) {&#x000A;          var expressions = [];&#x000A;          expression.scan(/(([\w#:.~&gt;+()\s-]+|\*|\[.*?\])+)\s*(,|$)/, function(m) {&#x000A;            expressions.push(m[1].strip());&#x000A;          });&#x000A;          return expressions;&#x000A;        },&#x000A;&#x000A;        matchElements: function(elements, expression) {&#x000A;          var matches = $$(expression), h = Selector.handlers;&#x000A;          h.mark(matches);&#x000A;          for (var i = 0, results = [], element; element = elements[i]; i++)&#x000A;            if (element._countedByPrototype) results.push(element);&#x000A;          h.unmark(matches);&#x000A;          return results;&#x000A;        },&#x000A;&#x000A;        findElement: function(elements, expression, index) {&#x000A;          if (Object.isNumber(expression)) {&#x000A;            index = expression; expression = false;&#x000A;          }&#x000A;          return Selector.matchElements(elements, expression || '*')[index || 0];&#x000A;        },&#x000A;&#x000A;        findChildElements: function(element, expressions) {&#x000A;          expressions = Selector.split(expressions.join(','));&#x000A;          var results = [], h = Selector.handlers;&#x000A;          for (var i = 0, l = expressions.length, selector; i &lt; l; i++) {&#x000A;            selector = new Selector(expressions[i].strip());&#x000A;            h.concat(results, selector.findElements(element));&#x000A;          }&#x000A;          return (l &gt; 1) ? h.unique(results) : results;&#x000A;        }&#x000A;      });&#x000A;&#x000A;      if (Prototype.Browser.IE) {&#x000A;        Object.extend(Selector.handlers, {&#x000A;          // IE returns comment nodes on getElementsByTagName(&quot;*&quot;).&#x000A;          // Filter them out.&#x000A;          concat: function(a, b) {&#x000A;            for (var i = 0, node; node = b[i]; i++)&#x000A;              if (node.tagName !== &quot;!&quot;) a.push(node);&#x000A;            return a;&#x000A;          },&#x000A;&#x000A;          // IE improperly serializes _countedByPrototype in (inner|outer)HTML.&#x000A;          unmark: function(nodes) {&#x000A;            for (var i = 0, node; node = nodes[i]; i++)&#x000A;              node.removeAttribute('_countedByPrototype');&#x000A;            return nodes;&#x000A;          }&#x000A;        });&#x000A;      }&#x000A;&#x000A;      function $$() {&#x000A;        return Selector.findChildElements(document, $A(arguments));&#x000A;      }&#x000A;      var Form = {&#x000A;        reset: function(form) {&#x000A;          $(form).reset();&#x000A;          return form;&#x000A;        },&#x000A;&#x000A;        serializeElements: function(elements, options) {&#x000A;          if (typeof options != 'object') options = { hash: !!options };&#x000A;          else if (Object.isUndefined(options.hash)) options.hash = true;&#x000A;          var key, value, submitted = false, submit = options.submit;&#x000A;&#x000A;          var data = elements.inject({ }, function(result, element) {&#x000A;            if (!element.disabled &amp;&amp; element.name) {&#x000A;              key = element.name; value = $(element).getValue();&#x000A;              if (value != null &amp;&amp; element.type != 'file' &amp;&amp; (element.type != 'submit' || (!submitted &amp;&amp;&#x000A;                  submit !== false &amp;&amp; (!submit || key == submit) &amp;&amp; (submitted = true)))) {&#x000A;                if (key in result) {&#x000A;                  // a key is already present; construct an array of values&#x000A;                  if (!Object.isArray(result[key])) result[key] = [result[key]];&#x000A;                  result[key].push(value);&#x000A;                }&#x000A;                else result[key] = value;&#x000A;              }&#x000A;            }&#x000A;            return result;&#x000A;          });&#x000A;&#x000A;          return options.hash ? data : Object.toQueryString(data);&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Form.Methods = {&#x000A;        serialize: function(form, options) {&#x000A;          return Form.serializeElements(Form.getElements(form), options);&#x000A;        },&#x000A;&#x000A;        getElements: function(form) {&#x000A;          return $A($(form).getElementsByTagName('*')).inject([],&#x000A;            function(elements, child) {&#x000A;              if (Form.Element.Serializers[child.tagName.toLowerCase()])&#x000A;                elements.push(Element.extend(child));&#x000A;              return elements;&#x000A;            }&#x000A;          );&#x000A;        },&#x000A;&#x000A;        getInputs: function(form, typeName, name) {&#x000A;          form = $(form);&#x000A;          var inputs = form.getElementsByTagName('input');&#x000A;&#x000A;          if (!typeName &amp;&amp; !name) return $A(inputs).map(Element.extend);&#x000A;&#x000A;          for (var i = 0, matchingInputs = [], length = inputs.length; i &lt; length; i++) {&#x000A;            var input = inputs[i];&#x000A;            if ((typeName &amp;&amp; input.type != typeName) || (name &amp;&amp; input.name != name))&#x000A;              continue;&#x000A;            matchingInputs.push(Element.extend(input));&#x000A;          }&#x000A;&#x000A;          return matchingInputs;&#x000A;        },&#x000A;&#x000A;        disable: function(form) {&#x000A;          form = $(form);&#x000A;          Form.getElements(form).invoke('disable');&#x000A;          return form;&#x000A;        },&#x000A;&#x000A;        enable: function(form) {&#x000A;          form = $(form);&#x000A;          Form.getElements(form).invoke('enable');&#x000A;          return form;&#x000A;        },&#x000A;&#x000A;        findFirstElement: function(form) {&#x000A;          var elements = $(form).getElements().findAll(function(element) {&#x000A;            return 'hidden' != element.type &amp;&amp; !element.disabled;&#x000A;          });&#x000A;          var firstByIndex = elements.findAll(function(element) {&#x000A;            return element.hasAttribute('tabIndex') &amp;&amp; element.tabIndex &gt;= 0;&#x000A;          }).sortBy(function(element) { return element.tabIndex }).first();&#x000A;&#x000A;          return firstByIndex ? firstByIndex : elements.find(function(element) {&#x000A;            return ['input', 'select', 'textarea'].include(element.tagName.toLowerCase());&#x000A;          });&#x000A;        },&#x000A;&#x000A;        focusFirstElement: function(form) {&#x000A;          form = $(form);&#x000A;          form.findFirstElement().activate();&#x000A;          return form;&#x000A;        },&#x000A;&#x000A;        request: function(form, options) {&#x000A;          form = $(form), options = Object.clone(options || { });&#x000A;&#x000A;          var params = options.parameters, action = form.readAttribute('action') || '';&#x000A;          if (action.blank()) action = window.location.href;&#x000A;          options.parameters = form.serialize(true);&#x000A;&#x000A;          if (params) {&#x000A;            if (Object.isString(params)) params = params.toQueryParams();&#x000A;            Object.extend(options.parameters, params);&#x000A;          }&#x000A;&#x000A;          if (form.hasAttribute('method') &amp;&amp; !options.method)&#x000A;            options.method = form.method;&#x000A;&#x000A;          return new Ajax.Request(action, options);&#x000A;        }&#x000A;      };&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Form.Element = {&#x000A;        focus: function(element) {&#x000A;          $(element).focus();&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        select: function(element) {&#x000A;          $(element).select();&#x000A;          return element;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Form.Element.Methods = {&#x000A;        serialize: function(element) {&#x000A;          element = $(element);&#x000A;          if (!element.disabled &amp;&amp; element.name) {&#x000A;            var value = element.getValue();&#x000A;            if (value != undefined) {&#x000A;              var pair = { };&#x000A;              pair[element.name] = value;&#x000A;              return Object.toQueryString(pair);&#x000A;            }&#x000A;          }&#x000A;          return '';&#x000A;        },&#x000A;&#x000A;        getValue: function(element) {&#x000A;          element = $(element);&#x000A;          var method = element.tagName.toLowerCase();&#x000A;          return Form.Element.Serializers[method](element);&#x000A;        },&#x000A;&#x000A;        setValue: function(element, value) {&#x000A;          element = $(element);&#x000A;          var method = element.tagName.toLowerCase();&#x000A;          Form.Element.Serializers[method](element, value);&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        clear: function(element) {&#x000A;          $(element).value = '';&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        present: function(element) {&#x000A;          return $(element).value != '';&#x000A;        },&#x000A;&#x000A;        activate: function(element) {&#x000A;          element = $(element);&#x000A;          try {&#x000A;            element.focus();&#x000A;            if (element.select &amp;&amp; (element.tagName.toLowerCase() != 'input' ||&#x000A;                !['button', 'reset', 'submit'].include(element.type)))&#x000A;              element.select();&#x000A;          } catch (e) { }&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        disable: function(element) {&#x000A;          element = $(element);&#x000A;          element.disabled = true;&#x000A;          return element;&#x000A;        },&#x000A;&#x000A;        enable: function(element) {&#x000A;          element = $(element);&#x000A;          element.disabled = false;&#x000A;          return element;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      var Field = Form.Element;&#x000A;      var $F = Form.Element.Methods.getValue;&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Form.Element.Serializers = {&#x000A;        input: function(element, value) {&#x000A;          switch (element.type.toLowerCase()) {&#x000A;            case 'checkbox':&#x000A;            case 'radio':&#x000A;              return Form.Element.Serializers.inputSelector(element, value);&#x000A;            default:&#x000A;              return Form.Element.Serializers.textarea(element, value);&#x000A;          }&#x000A;        },&#x000A;&#x000A;        inputSelector: function(element, value) {&#x000A;          if (Object.isUndefined(value)) return element.checked ? element.value : null;&#x000A;          else element.checked = !!value;&#x000A;        },&#x000A;&#x000A;        textarea: function(element, value) {&#x000A;          if (Object.isUndefined(value)) return element.value;&#x000A;          else element.value = value;&#x000A;        },&#x000A;&#x000A;        select: function(element, value) {&#x000A;          if (Object.isUndefined(value))&#x000A;            return this[element.type == 'select-one' ?&#x000A;              'selectOne' : 'selectMany'](element);&#x000A;          else {&#x000A;            var opt, currentValue, single = !Object.isArray(value);&#x000A;            for (var i = 0, length = element.length; i &lt; length; i++) {&#x000A;              opt = element.options[i];&#x000A;              currentValue = this.optionValue(opt);&#x000A;              if (single) {&#x000A;                if (currentValue == value) {&#x000A;                  opt.selected = true;&#x000A;                  return;&#x000A;                }&#x000A;              }&#x000A;              else opt.selected = value.include(currentValue);&#x000A;            }&#x000A;          }&#x000A;        },&#x000A;&#x000A;        selectOne: function(element) {&#x000A;          var index = element.selectedIndex;&#x000A;          return index &gt;= 0 ? this.optionValue(element.options[index]) : null;&#x000A;        },&#x000A;&#x000A;        selectMany: function(element) {&#x000A;          var values, length = element.length;&#x000A;          if (!length) return null;&#x000A;&#x000A;          for (var i = 0, values = []; i &lt; length; i++) {&#x000A;            var opt = element.options[i];&#x000A;            if (opt.selected) values.push(this.optionValue(opt));&#x000A;          }&#x000A;          return values;&#x000A;        },&#x000A;&#x000A;        optionValue: function(opt) {&#x000A;          // extend element because hasAttribute may not be native&#x000A;          return Element.extend(opt).hasAttribute('value') ? opt.value : opt.text;&#x000A;        }&#x000A;      };&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Abstract.TimedObserver = Class.create(PeriodicalExecuter, {&#x000A;        initialize: function($super, element, frequency, callback) {&#x000A;          $super(callback, frequency);&#x000A;          this.element   = $(element);&#x000A;          this.lastValue = this.getValue();&#x000A;        },&#x000A;&#x000A;        execute: function() {&#x000A;          var value = this.getValue();&#x000A;          if (Object.isString(this.lastValue) &amp;&amp; Object.isString(value) ?&#x000A;              this.lastValue != value : String(this.lastValue) != String(value)) {&#x000A;            this.callback(this.element, value);&#x000A;            this.lastValue = value;&#x000A;          }&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Form.Element.Observer = Class.create(Abstract.TimedObserver, {&#x000A;        getValue: function() {&#x000A;          return Form.Element.getValue(this.element);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Form.Observer = Class.create(Abstract.TimedObserver, {&#x000A;        getValue: function() {&#x000A;          return Form.serialize(this.element);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Abstract.EventObserver = Class.create({&#x000A;        initialize: function(element, callback) {&#x000A;          this.element  = $(element);&#x000A;          this.callback = callback;&#x000A;&#x000A;          this.lastValue = this.getValue();&#x000A;          if (this.element.tagName.toLowerCase() == 'form')&#x000A;            this.registerFormCallbacks();&#x000A;          else&#x000A;            this.registerCallback(this.element);&#x000A;        },&#x000A;&#x000A;        onElementEvent: function() {&#x000A;          var value = this.getValue();&#x000A;          if (this.lastValue != value) {&#x000A;            this.callback(this.element, value);&#x000A;            this.lastValue = value;&#x000A;          }&#x000A;        },&#x000A;&#x000A;        registerFormCallbacks: function() {&#x000A;          Form.getElements(this.element).each(this.registerCallback, this);&#x000A;        },&#x000A;&#x000A;        registerCallback: function(element) {&#x000A;          if (element.type) {&#x000A;            switch (element.type.toLowerCase()) {&#x000A;              case 'checkbox':&#x000A;              case 'radio':&#x000A;                Event.observe(element, 'click', this.onElementEvent.bind(this));&#x000A;                break;&#x000A;              default:&#x000A;                Event.observe(element, 'change', this.onElementEvent.bind(this));&#x000A;                break;&#x000A;            }&#x000A;          }&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Form.Element.EventObserver = Class.create(Abstract.EventObserver, {&#x000A;        getValue: function() {&#x000A;          return Form.Element.getValue(this.element);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Form.EventObserver = Class.create(Abstract.EventObserver, {&#x000A;        getValue: function() {&#x000A;          return Form.serialize(this.element);&#x000A;        }&#x000A;      });&#x000A;      if (!window.Event) var Event = { };&#x000A;&#x000A;      Object.extend(Event, {&#x000A;        KEY_BACKSPACE: 8,&#x000A;        KEY_TAB:       9,&#x000A;        KEY_RETURN:   13,&#x000A;        KEY_ESC:      27,&#x000A;        KEY_LEFT:     37,&#x000A;        KEY_UP:       38,&#x000A;        KEY_RIGHT:    39,&#x000A;        KEY_DOWN:     40,&#x000A;        KEY_DELETE:   46,&#x000A;        KEY_HOME:     36,&#x000A;        KEY_END:      35,&#x000A;        KEY_PAGEUP:   33,&#x000A;        KEY_PAGEDOWN: 34,&#x000A;        KEY_INSERT:   45,&#x000A;&#x000A;        cache: { },&#x000A;&#x000A;        relatedTarget: function(event) {&#x000A;          var element;&#x000A;          switch(event.type) {&#x000A;            case 'mouseover': element = event.fromElement; break;&#x000A;            case 'mouseout':  element = event.toElement;   break;&#x000A;            default: return null;&#x000A;          }&#x000A;          return Element.extend(element);&#x000A;        }&#x000A;      });&#x000A;&#x000A;      Event.Methods = (function() {&#x000A;        var isButton;&#x000A;&#x000A;        if (Prototype.Browser.IE) {&#x000A;          var buttonMap = { 0: 1, 1: 4, 2: 2 };&#x000A;          isButton = function(event, code) {&#x000A;            return event.button == buttonMap[code];&#x000A;          };&#x000A;&#x000A;        } else if (Prototype.Browser.WebKit) {&#x000A;          isButton = function(event, code) {&#x000A;            switch (code) {&#x000A;              case 0: return event.which == 1 &amp;&amp; !event.metaKey;&#x000A;              case 1: return event.which == 1 &amp;&amp; event.metaKey;&#x000A;              default: return false;&#x000A;            }&#x000A;          };&#x000A;&#x000A;        } else {&#x000A;          isButton = function(event, code) {&#x000A;            return event.which ? (event.which === code + 1) : (event.button === code);&#x000A;          };&#x000A;        }&#x000A;&#x000A;        return {&#x000A;          isLeftClick:   function(event) { return isButton(event, 0) },&#x000A;          isMiddleClick: function(event) { return isButton(event, 1) },&#x000A;          isRightClick:  function(event) { return isButton(event, 2) },&#x000A;&#x000A;          element: function(event) {&#x000A;            event = Event.extend(event);&#x000A;&#x000A;            var node          = event.target,&#x000A;                type          = event.type,&#x000A;                currentTarget = event.currentTarget;&#x000A;&#x000A;            if (currentTarget &amp;&amp; currentTarget.tagName) {&#x000A;              // Firefox screws up the &quot;click&quot; event when moving between radio buttons&#x000A;              // via arrow keys. It also screws up the &quot;load&quot; and &quot;error&quot; events on images,&#x000A;              // reporting the document as the target instead of the original image.&#x000A;              if (type === 'load' || type === 'error' ||&#x000A;                (type === 'click' &amp;&amp; currentTarget.tagName.toLowerCase() === 'input'&#x000A;                  &amp;&amp; currentTarget.type === 'radio'))&#x000A;                    node = currentTarget;&#x000A;            }&#x000A;            if (node.nodeType == Node.TEXT_NODE) node = node.parentNode;&#x000A;            return Element.extend(node);&#x000A;          },&#x000A;&#x000A;          findElement: function(event, expression) {&#x000A;            var element = Event.element(event);&#x000A;            if (!expression) return element;&#x000A;            var elements = [element].concat(element.ancestors());&#x000A;            return Selector.findElement(elements, expression, 0);&#x000A;          },&#x000A;&#x000A;          pointer: function(event) {&#x000A;            var docElement = document.documentElement,&#x000A;            body = document.body || { scrollLeft: 0, scrollTop: 0 };&#x000A;            return {&#x000A;              x: event.pageX || (event.clientX +&#x000A;                (docElement.scrollLeft || body.scrollLeft) -&#x000A;                (docElement.clientLeft || 0)),&#x000A;              y: event.pageY || (event.clientY +&#x000A;                (docElement.scrollTop || body.scrollTop) -&#x000A;                (docElement.clientTop || 0))&#x000A;            };&#x000A;          },&#x000A;&#x000A;          pointerX: function(event) { return Event.pointer(event).x },&#x000A;          pointerY: function(event) { return Event.pointer(event).y },&#x000A;&#x000A;          stop: function(event) {&#x000A;            Event.extend(event);&#x000A;            event.preventDefault();&#x000A;            event.stopPropagation();&#x000A;            event.stopped = true;&#x000A;          }&#x000A;        };&#x000A;      })();&#x000A;&#x000A;      Event.extend = (function() {&#x000A;        var methods = Object.keys(Event.Methods).inject({ }, function(m, name) {&#x000A;          m[name] = Event.Methods[name].methodize();&#x000A;          return m;&#x000A;        });&#x000A;&#x000A;        if (Prototype.Browser.IE) {&#x000A;          Object.extend(methods, {&#x000A;            stopPropagation: function() { this.cancelBubble = true },&#x000A;            preventDefault:  function() { this.returnValue = false },&#x000A;            inspect: function() { return &quot;[object Event]&quot; }&#x000A;          });&#x000A;&#x000A;          return function(event) {&#x000A;            if (!event) return false;&#x000A;            if (event._extendedByPrototype) return event;&#x000A;&#x000A;            event._extendedByPrototype = Prototype.emptyFunction;&#x000A;            var pointer = Event.pointer(event);&#x000A;            Object.extend(event, {&#x000A;              target: event.srcElement,&#x000A;              relatedTarget: Event.relatedTarget(event),&#x000A;              pageX:  pointer.x,&#x000A;              pageY:  pointer.y&#x000A;            });&#x000A;            return Object.extend(event, methods);&#x000A;          };&#x000A;&#x000A;        } else {&#x000A;          Event.prototype = Event.prototype || document.createEvent(&quot;HTMLEvents&quot;)['__proto__'];&#x000A;          Object.extend(Event.prototype, methods);&#x000A;          return Prototype.K;&#x000A;        }&#x000A;      })();&#x000A;&#x000A;      Object.extend(Event, (function() {&#x000A;        var cache = Event.cache;&#x000A;&#x000A;        function getEventID(element) {&#x000A;          if (element._prototypeEventID) return element._prototypeEventID[0];&#x000A;          arguments.callee.id = arguments.callee.id || 1;&#x000A;          return element._prototypeEventID = [++arguments.callee.id];&#x000A;        }&#x000A;&#x000A;        function getDOMEventName(eventName) {&#x000A;          if (eventName &amp;&amp; eventName.include(':')) return &quot;dataavailable&quot;;&#x000A;          return eventName;&#x000A;        }&#x000A;&#x000A;        function getCacheForID(id) {&#x000A;          return cache[id] = cache[id] || { };&#x000A;        }&#x000A;&#x000A;        function getWrappersForEventName(id, eventName) {&#x000A;          var c = getCacheForID(id);&#x000A;          return c[eventName] = c[eventName] || [];&#x000A;        }&#x000A;&#x000A;        function createWrapper(element, eventName, handler) {&#x000A;          var id = getEventID(element);&#x000A;          var c = getWrappersForEventName(id, eventName);&#x000A;          if (c.pluck(&quot;handler&quot;).include(handler)) return false;&#x000A;&#x000A;          var wrapper = function(event) {&#x000A;            if (!Event || !Event.extend ||&#x000A;              (event.eventName &amp;&amp; event.eventName != eventName))&#x000A;                return false;&#x000A;&#x000A;            Event.extend(event);&#x000A;            handler.call(element, event);&#x000A;          };&#x000A;&#x000A;          wrapper.handler = handler;&#x000A;          c.push(wrapper);&#x000A;          return wrapper;&#x000A;        }&#x000A;&#x000A;        function findWrapper(id, eventName, handler) {&#x000A;          var c = getWrappersForEventName(id, eventName);&#x000A;          return c.find(function(wrapper) { return wrapper.handler == handler });&#x000A;        }&#x000A;&#x000A;        function destroyWrapper(id, eventName, handler) {&#x000A;          var c = getCacheForID(id);&#x000A;          if (!c[eventName]) return false;&#x000A;          c[eventName] = c[eventName].without(findWrapper(id, eventName, handler));&#x000A;        }&#x000A;&#x000A;        function destroyCache() {&#x000A;          for (var id in cache)&#x000A;            for (var eventName in cache[id])&#x000A;              cache[id][eventName] = null;&#x000A;        }&#x000A;&#x000A;        // Internet Explorer needs to remove event handlers on page unload&#x000A;        // in order to avoid memory leaks.&#x000A;        if (window.attachEvent) {&#x000A;          window.attachEvent(&quot;onunload&quot;, destroyCache);&#x000A;        }&#x000A;&#x000A;        // Safari has a dummy event handler on page unload so that it won't&#x000A;        // use its bfcache. Safari &lt;= 3.1 has an issue with restoring the &quot;document&quot;&#x000A;        // object when page is returned to via the back button using its bfcache.&#x000A;        if (Prototype.Browser.WebKit) {&#x000A;          window.addEventListener('unload', Prototype.emptyFunction, false);&#x000A;        }&#x000A;&#x000A;        return {&#x000A;          observe: function(element, eventName, handler) {&#x000A;            element = $(element);&#x000A;            var name = getDOMEventName(eventName);&#x000A;&#x000A;            var wrapper = createWrapper(element, eventName, handler);&#x000A;            if (!wrapper) return element;&#x000A;&#x000A;            if (element.addEventListener) {&#x000A;              element.addEventListener(name, wrapper, false);&#x000A;            } else {&#x000A;              element.attachEvent(&quot;on&quot; + name, wrapper);&#x000A;            }&#x000A;&#x000A;            return element;&#x000A;          },&#x000A;&#x000A;          stopObserving: function(element, eventName, handler) {&#x000A;            element = $(element);&#x000A;            var id = getEventID(element), name = getDOMEventName(eventName);&#x000A;&#x000A;            if (!handler &amp;&amp; eventName) {&#x000A;              getWrappersForEventName(id, eventName).each(function(wrapper) {&#x000A;                element.stopObserving(eventName, wrapper.handler);&#x000A;              });&#x000A;              return element;&#x000A;&#x000A;            } else if (!eventName) {&#x000A;              Object.keys(getCacheForID(id)).each(function(eventName) {&#x000A;                element.stopObserving(eventName);&#x000A;              });&#x000A;              return element;&#x000A;            }&#x000A;&#x000A;            var wrapper = findWrapper(id, eventName, handler);&#x000A;            if (!wrapper) return element;&#x000A;&#x000A;            if (element.removeEventListener) {&#x000A;              element.removeEventListener(name, wrapper, false);&#x000A;            } else {&#x000A;              element.detachEvent(&quot;on&quot; + name, wrapper);&#x000A;            }&#x000A;&#x000A;            destroyWrapper(id, eventName, handler);&#x000A;&#x000A;            return element;&#x000A;          },&#x000A;&#x000A;          fire: function(element, eventName, memo) {&#x000A;            element = $(element);&#x000A;            if (element == document &amp;&amp; document.createEvent &amp;&amp; !element.dispatchEvent)&#x000A;              element = document.documentElement;&#x000A;&#x000A;            var event;&#x000A;            if (document.createEvent) {&#x000A;              event = document.createEvent(&quot;HTMLEvents&quot;);&#x000A;              event.initEvent(&quot;dataavailable&quot;, true, true);&#x000A;            } else {&#x000A;              event = document.createEventObject();&#x000A;              event.eventType = &quot;ondataavailable&quot;;&#x000A;            }&#x000A;&#x000A;            event.eventName = eventName;&#x000A;            event.memo = memo || { };&#x000A;&#x000A;            if (document.createEvent) {&#x000A;              element.dispatchEvent(event);&#x000A;            } else {&#x000A;              element.fireEvent(event.eventType, event);&#x000A;            }&#x000A;&#x000A;            return Event.extend(event);&#x000A;          }&#x000A;        };&#x000A;      })());&#x000A;&#x000A;      Object.extend(Event, Event.Methods);&#x000A;&#x000A;      Element.addMethods({&#x000A;        fire:          Event.fire,&#x000A;        observe:       Event.observe,&#x000A;        stopObserving: Event.stopObserving&#x000A;      });&#x000A;&#x000A;      Object.extend(document, {&#x000A;        fire:          Element.Methods.fire.methodize(),&#x000A;        observe:       Element.Methods.observe.methodize(),&#x000A;        stopObserving: Element.Methods.stopObserving.methodize(),&#x000A;        loaded:        false&#x000A;      });&#x000A;&#x000A;      (function() {&#x000A;        /* Support for the DOMContentLoaded event is based on work by Dan Webb,&#x000A;           Matthias Miller, Dean Edwards and John Resig. */&#x000A;&#x000A;        var timer;&#x000A;&#x000A;        function fireContentLoadedEvent() {&#x000A;          if (document.loaded) return;&#x000A;          if (timer) window.clearInterval(timer);&#x000A;          document.fire(&quot;dom:loaded&quot;);&#x000A;          document.loaded = true;&#x000A;        }&#x000A;&#x000A;        if (document.addEventListener) {&#x000A;          if (Prototype.Browser.WebKit) {&#x000A;            timer = window.setInterval(function() {&#x000A;              if (/loaded|complete/.test(document.readyState))&#x000A;                fireContentLoadedEvent();&#x000A;            }, 0);&#x000A;&#x000A;            Event.observe(window, &quot;load&quot;, fireContentLoadedEvent);&#x000A;&#x000A;          } else {&#x000A;            document.addEventListener(&quot;DOMContentLoaded&quot;,&#x000A;              fireContentLoadedEvent, false);&#x000A;          }&#x000A;&#x000A;        } else {&#x000A;          document.write(&quot;&lt;script id=__onDOMContentLoaded defer src=//:&gt;&lt;\/script&gt;&quot;);&#x000A;          $(&quot;__onDOMContentLoaded&quot;).onreadystatechange = function() {&#x000A;            if (this.readyState == &quot;complete&quot;) {&#x000A;              this.onreadystatechange = null;&#x000A;              fireContentLoadedEvent();&#x000A;            }&#x000A;          };&#x000A;        }&#x000A;      })();&#x000A;      /*------------------------------- DEPRECATED -------------------------------*/&#x000A;&#x000A;      Hash.toQueryString = Object.toQueryString;&#x000A;&#x000A;      var Toggle = { display: Element.toggle };&#x000A;&#x000A;      Element.Methods.childOf = Element.Methods.descendantOf;&#x000A;&#x000A;      var Insertion = {&#x000A;        Before: function(element, content) {&#x000A;          return Element.insert(element, {before:content});&#x000A;        },&#x000A;&#x000A;        Top: function(element, content) {&#x000A;          return Element.insert(element, {top:content});&#x000A;        },&#x000A;&#x000A;        Bottom: function(element, content) {&#x000A;          return Element.insert(element, {bottom:content});&#x000A;        },&#x000A;&#x000A;        After: function(element, content) {&#x000A;          return Element.insert(element, {after:content});&#x000A;        }&#x000A;      };&#x000A;&#x000A;      var $continue = new Error('&quot;throw $continue&quot; is deprecated, use &quot;return&quot; instead');&#x000A;&#x000A;      // This should be moved to script.aculo.us; notice the deprecated methods&#x000A;      // further below, that map to the newer Element methods.&#x000A;      var Position = {&#x000A;        // set to true if needed, warning: firefox performance problems&#x000A;        // NOT neeeded for page scrolling, only if draggable contained in&#x000A;        // scrollable elements&#x000A;        includeScrollOffsets: false,&#x000A;&#x000A;        // must be called before calling withinIncludingScrolloffset, every time the&#x000A;        // page is scrolled&#x000A;        prepare: function() {&#x000A;          this.deltaX =  window.pageXOffset&#x000A;                      || document.documentElement.scrollLeft&#x000A;                      || document.body.scrollLeft&#x000A;                      || 0;&#x000A;          this.deltaY =  window.pageYOffset&#x000A;                      || document.documentElement.scrollTop&#x000A;                      || document.body.scrollTop&#x000A;                      || 0;&#x000A;        },&#x000A;&#x000A;        // caches x/y coordinate pair to use with overlap&#x000A;        within: function(element, x, y) {&#x000A;          if (this.includeScrollOffsets)&#x000A;            return this.withinIncludingScrolloffsets(element, x, y);&#x000A;          this.xcomp = x;&#x000A;          this.ycomp = y;&#x000A;          this.offset = Element.cumulativeOffset(element);&#x000A;&#x000A;          return (y &gt;= this.offset[1] &amp;&amp;&#x000A;                  y &lt;  this.offset[1] + element.offsetHeight &amp;&amp;&#x000A;                  x &gt;= this.offset[0] &amp;&amp;&#x000A;                  x &lt;  this.offset[0] + element.offsetWidth);&#x000A;        },&#x000A;&#x000A;        withinIncludingScrolloffsets: function(element, x, y) {&#x000A;          var offsetcache = Element.cumulativeScrollOffset(element);&#x000A;&#x000A;          this.xcomp = x + offsetcache[0] - this.deltaX;&#x000A;          this.ycomp = y + offsetcache[1] - this.deltaY;&#x000A;          this.offset = Element.cumulativeOffset(element);&#x000A;&#x000A;          return (this.ycomp &gt;= this.offset[1] &amp;&amp;&#x000A;                  this.ycomp &lt;  this.offset[1] + element.offsetHeight &amp;&amp;&#x000A;                  this.xcomp &gt;= this.offset[0] &amp;&amp;&#x000A;                  this.xcomp &lt;  this.offset[0] + element.offsetWidth);&#x000A;        },&#x000A;&#x000A;        // within must be called directly before&#x000A;        overlap: function(mode, element) {&#x000A;          if (!mode) return 0;&#x000A;          if (mode == 'vertical')&#x000A;            return ((this.offset[1] + element.offsetHeight) - this.ycomp) /&#x000A;              element.offsetHeight;&#x000A;          if (mode == 'horizontal')&#x000A;            return ((this.offset[0] + element.offsetWidth) - this.xcomp) /&#x000A;              element.offsetWidth;&#x000A;        },&#x000A;&#x000A;        // Deprecation layer -- use newer Element methods now (1.5.2).&#x000A;&#x000A;        cumulativeOffset: Element.Methods.cumulativeOffset,&#x000A;&#x000A;        positionedOffset: Element.Methods.positionedOffset,&#x000A;&#x000A;        absolutize: function(element) {&#x000A;          Position.prepare();&#x000A;          return Element.absolutize(element);&#x000A;        },&#x000A;&#x000A;        relativize: function(element) {&#x000A;          Position.prepare();&#x000A;          return Element.relativize(element);&#x000A;        },&#x000A;&#x000A;        realOffset: Element.Methods.cumulativeScrollOffset,&#x000A;&#x000A;        offsetParent: Element.Methods.getOffsetParent,&#x000A;&#x000A;        page: Element.Methods.viewportOffset,&#x000A;&#x000A;        clone: function(source, target, options) {&#x000A;          options = options || { };&#x000A;          return Element.clonePosition(target, source, options);&#x000A;        }&#x000A;      };&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      if (!document.getElementsByClassName) document.getElementsByClassName = function(instanceMethods){&#x000A;        function iter(name) {&#x000A;          return name.blank() ? null : &quot;[contains(concat(' ', @class, ' '), ' &quot; + name + &quot; ')]&quot;;&#x000A;        }&#x000A;&#x000A;        instanceMethods.getElementsByClassName = Prototype.BrowserFeatures.XPath ?&#x000A;        function(element, className) {&#x000A;          className = className.toString().strip();&#x000A;          var cond = /\s/.test(className) ? $w(className).map(iter).join('') : iter(className);&#x000A;          return cond ? document._getElementsByXPath('.//*' + cond, element) : [];&#x000A;        } : function(element, className) {&#x000A;          className = className.toString().strip();&#x000A;          var elements = [], classNames = (/\s/.test(className) ? $w(className) : null);&#x000A;          if (!classNames &amp;&amp; !className) return elements;&#x000A;&#x000A;          var nodes = $(element).getElementsByTagName('*');&#x000A;          className = ' ' + className + ' ';&#x000A;&#x000A;          for (var i = 0, child, cn; child = nodes[i]; i++) {&#x000A;            if (child.className &amp;&amp; (cn = ' ' + child.className + ' ') &amp;&amp; (cn.include(className) ||&#x000A;                (classNames &amp;&amp; classNames.all(function(name) {&#x000A;                  return !name.toString().blank() &amp;&amp; cn.include(' ' + name + ' ');&#x000A;                }))))&#x000A;              elements.push(Element.extend(child));&#x000A;          }&#x000A;          return elements;&#x000A;        };&#x000A;&#x000A;        return function(className, parentElement) {&#x000A;          return $(parentElement || document.body).getElementsByClassName(className);&#x000A;        };&#x000A;      }(Element.Methods);&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Element.ClassNames = Class.create();&#x000A;      Element.ClassNames.prototype = {&#x000A;        initialize: function(element) {&#x000A;          this.element = $(element);&#x000A;        },&#x000A;&#x000A;        _each: function(iterator) {&#x000A;          this.element.className.split(/\s+/).select(function(name) {&#x000A;            return name.length &gt; 0;&#x000A;          })._each(iterator);&#x000A;        },&#x000A;&#x000A;        set: function(className) {&#x000A;          this.element.className = className;&#x000A;        },&#x000A;&#x000A;        add: function(classNameToAdd) {&#x000A;          if (this.include(classNameToAdd)) return;&#x000A;          this.set($A(this).concat(classNameToAdd).join(' '));&#x000A;        },&#x000A;&#x000A;        remove: function(classNameToRemove) {&#x000A;          if (!this.include(classNameToRemove)) return;&#x000A;          this.set($A(this).without(classNameToRemove).join(' '));&#x000A;        },&#x000A;&#x000A;        toString: function() {&#x000A;          return $A(this).join(' ');&#x000A;        }&#x000A;      };&#x000A;&#x000A;      Object.extend(Element.ClassNames.prototype, Enumerable);&#x000A;&#x000A;      /*--------------------------------------------------------------------------*/&#x000A;&#x000A;      Element.addMethods();&#x000A;      var search_index = [&#x000A;        { method: 'acts_as_sane_tree', module: 'actsassanetree::classmethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/ClassMethods.html#M000001&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;acts_as_sane_tree&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::ClassMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'ancestors', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000002&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;ancestors&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'depth', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000008&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'descendents', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000007&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;descendents&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'root', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000003&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'root?', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000006&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;root?&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'self_and_siblings', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000005&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;self_and_siblings&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;        { method: 'siblings', module: 'actsassanetree::instancemethods', html: '&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000004&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;siblings&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;' },&#x000A;      ]&#x000A;      $(document).observe('dom:loaded', function() {&#x000A;              // Setup search-during-typing.&#x000A;              new Form.Element.Observer('search', 0.3, function(element, value) {&#x000A;                      performSearch();&#x000A;              });&#x000A;&#x000A;              // Remove the default search box value when the user puts the focus on&#x000A;              // the search box for the first time.&#x000A;              var search_box = $('search');&#x000A;              if ($F('search') == 'Enter search terms...') {&#x000A;                      search_box.observe('focus', function() {&#x000A;                              if (search_box.hasClassName('untouched')) {&#x000A;                                      search_box.removeClassName('untouched');&#x000A;                                      search_box.value = '';&#x000A;                              }&#x000A;                      });&#x000A;              } else {&#x000A;                      search_box.removeClassName('untouched');&#x000A;              }&#x000A;&#x000A;              search_box.insert({&#x000A;                after: new Element('span', { 'class': 'clear_button' }).update('x').observe('click', function(e) {&#x000A;                  e.stopPropagation()&#x000A;                search_box.setValue('')&#x000A;                search_box.focus()&#x000A;              })&#x000A;        })&#x000A;      });&#x000A;&#x000A;      function searchInIndex(query) {&#x000A;              var i;&#x000A;              var results = [];&#x000A;              query = query.toLowerCase();&#x000A;              for (i = 0; i &lt; search_index.length; i++) {&#x000A;                      if (search_index[i].method.indexOf(query) != -1) {&#x000A;                              results.push(search_index[i]);&#x000A;                      }&#x000A;              }&#x000A;              return results;&#x000A;      }&#x000A;&#x000A;      function buildHtmlForResults(results) {&#x000A;              var html = &quot;&quot;;&#x000A;              var i;&#x000A;              for (i = 0; i &lt; results.length; i++) {&#x000A;                      html += '&lt;li&gt;' + results[i].html + '&lt;/li&gt;';&#x000A;              }&#x000A;              return html;&#x000A;      }&#x000A;&#x000A;      function performSearch() {&#x000A;              var query = $F('search');&#x000A;              if (query == '') {&#x000A;                      $('index-entries').show();&#x000A;                      $('search-results').hide();&#x000A;              } else {&#x000A;                      var results = searchInIndex(query);&#x000A;                      $('search-results').update(buildHtmlForResults(results));&#x000A;                      $('index-entries').hide();&#x000A;                      $('search-results').show();&#x000A;              }&#x000A;              return false;&#x000A;      }&#x000A;    &lt;/script&gt;&#x000A;    &lt;form onsubmit='return performSearch()'&gt;&#x000A;      &lt;input class='untouched' id='search' type='text' value='Enter search terms...'&gt;&#x000A;    &lt;/form&gt;&#x000A;    &lt;ol class='methods' id='search-results' style='display: none'&gt;&lt;/ol&gt;&#x000A;    &lt;ol class='methods' id='index-entries'&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/ClassMethods.html#M000001&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;acts_as_sane_tree&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::ClassMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000002&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;ancestors&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000008&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;depth&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000007&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;descendents&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000003&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000006&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;root?&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000005&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;self_and_siblings&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;      &lt;li&gt;&lt;a href=&quot;classes/ActsAsSaneTree/InstanceMethods.html#M000004&quot;&gt;&lt;span class=&quot;method_name&quot;&gt;siblings&lt;/span&gt; &lt;span class=&quot;module_name&quot;&gt;(ActsAsSaneTree::InstanceMethods)&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;&#x000A;    &lt;/ol&gt;&#x000A;  &lt;/div&gt;&#x000A;&lt;/body&gt;</pre>
            <p>
            </html>
            </p>
          </div>
          <div id='section'>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
